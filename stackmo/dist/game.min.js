!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=22)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Vastgame",function(){return y});var i=n(16),o=n(1),r=n(4),a=n(17),s=n(18),c=n(7),u=n(8);n.d(e,"Actor",function(){return u.a});var l=n(10);n.d(e,"ActorInstance",function(){return l.a});var h=n(9);n.d(e,"Boundary",function(){return h.a}),n.d(e,"Direction",function(){return o.b}),n.d(e,"Key",function(){return o.d}),n.d(e,"Input",function(){return r.a});var f=n(11);n.d(e,"Grid",function(){return f.a}),n.d(e,"GridCell",function(){return f.b}),n.d(e,"Room",function(){return c.a});var p=n(14);n.d(e,"GridRoomBehavior",function(){return p.a}),n.d(e,"ViewedRoomBehavior",function(){return p.b});var d=n(21);n.d(e,"Sprite",function(){return d.a});var g=n(5);n.d(e,"SpriteAnimation",function(){return g.a}),n.d(e,"SpriteTransformation",function(){return g.b});var v=n(12);n.d(e,"View",function(){return v.a});var m=function(){function t(){}return t.prototype.init=function(t,e){r.a.init();var n=document.getElementById(t),o=new i.a(n);o.init(e.canvas),this.context=new a.a(o),this.runner=new s.a(e)},t.prototype.getContext=function(){return this.context},t.prototype.start=function(t){this.setRoom(t),this.runner.start(this.context)},t.prototype.setRoom=function(t,e){var n=c.a.get(t),i=this.context.getCurrentRoom();i&&i.end(),this.context.setCurrentRoom(n),n._callStart(e)},t}(),y=function(){function t(){}return t.init=function(t,e){this.game.init(t,e)},t.start=function(t){return this.game.start(t),this.game},t.setRoom=function(t,e){this.game.setRoom(t,e)},t._getContext=function(){return this.game.getContext()},t.game=new m,t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"d",function(){return a});var i;!function(t){t[t.Active=1]="Active",t[t.Destroyed=2]="Destroyed"}(i||(i={}));var o;!function(t){t[t.Right=0]="Right",t[t.Down=90]="Down",t[t.Left=180]="Left",t[t.Up=270]="Up"}(o||(o={}));var r;!function(t){t[t.Running=1]="Running",t[t.Paused=2]="Paused"}(r||(r={}));var a;!function(t){t[t.Any=-1]="Any",t[t.Space=32]="Space",t[t.Left=37]="Left",t[t.Up=38]="Up",t[t.Right=39]="Right",t[t.Down=40]="Down"}(a||(a={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Settings",function(){return i}),n.d(e,"ActorID",function(){return o}),n.d(e,"RoomID",function(){return r}),n.d(e,"SpriteID",function(){return a}),n.d(e,"GameAction",function(){return s}),n.d(e,"LevelBgColor",function(){return c}),n.d(e,"StackmoFrame",function(){return u});var i;!function(t){t.CanvasWidth="CanvasWidth",t.CanvasHeight="CanvasHeight",t.StackmoProgress="StackmoProgress"}(i||(i={}));var o;!function(t){t.ExitButton="BackButton",t.Block="Block",t.LevelIcon="LevelIcon",t.Player="Player",t.ScrollArrow="ScrollArrow",t.Title="Title",t.Wall="Wall",t.Win="Win"}(o||(o={}));var r;!function(t){t.Title="Title",t.LevelSelect="LevelSelect",t.Level="Level"}(r||(r={}));var a;!function(t){t.ArrowSheet="Arrows",t.Digits="Digits",t.DoorSheet="DoorSheet",t.Box="Box",t.HUD="HUD",t.LevelIcon="LevelIcon",t.StackmoSheet="StackmoSheet",t.TextSheet="TextSheet",t.Title="Title",t.Wall="Wall",t.ExitButton="X"}(a||(a={}));var s;!function(t){t.Drop="Drop",t.Fall="Fall",t.StopFalling="StopFalling",t.Jump="Jump",t.Lift="Lift",t.Move="Move",t.CheckStopMoving="CheckStopMoving",t.Stop="Stop",t.Turn="Turn",t.Win="Win"}(s||(s={}));var c;!function(t){t.DarkTeal="#001820",t.Teal="#006070",t.DarkGreen="#001800",t.Green="#085800",t.DarkRed="#580000",t.Red="#d01000",t.DarkPurple="#380050",t.Purple="#a008a8"}(c||(c={}));var u;!function(t){t[t.StandLeft=0]="StandLeft",t[t.MoveLeft1=1]="MoveLeft1",t[t.MoveLeft2=2]="MoveLeft2",t[t.StandRight=3]="StandRight",t[t.MoveRight1=4]="MoveRight1",t[t.MoveRight2=5]="MoveRight2",t[t.StandHoldLeft=6]="StandHoldLeft",t[t.MoveHoldLeft1=7]="MoveHoldLeft1",t[t.MoveHoldLeft2=8]="MoveHoldLeft2",t[t.StandHoldRight=9]="StandHoldRight",t[t.MoveHoldRight1=10]="MoveHoldRight1",t[t.MoveHolddRight2=11]="MoveHolddRight2"}(u||(u={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Black",function(){return i}),n.d(e,"CanvasMaxWidth",function(){return o}),n.d(e,"CanvasMaxHeight",function(){return r}),n.d(e,"GridCellSize",function(){return a}),n.d(e,"BlockFallSpeed",function(){return s}),n.d(e,"PlayerMoveSpeed",function(){return c}),n.d(e,"PlayerJumpSpeed",function(){return u}),n.d(e,"PlayerFallSpeed",function(){return l}),n.d(e,"TitleWidth",function(){return h}),n.d(e,"TitleHeight",function(){return f});var i="#000",o=1024,r=768,a=64,s=8,c=4,u=8,l=8,h=360,f=150},function(t,e,n){"use strict";function i(t){return t.offsetX}function o(t){return t.offsetY}function r(t){var e=t.touches[0];return e?e.clientX:0}function a(t){var e=t.touches[0];return e?e.clientY:0}n.d(e,"a",function(){return c});var s=n(1),c=function(){function t(){}return Object.defineProperty(t,"clickActive",{get:function(){return!!t._activePointerEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t,"activePointerEvent",{get:function(){return t._activePointerEvent},enumerable:!0,configurable:!0}),t.init=function(){function e(e){t._activePointerEvent.currentX=i(e),t._activePointerEvent.currentY=o(e)}function n(e){document.body.onmousemove=null,t._activePointerEvent.currentX=r(e),t._activePointerEvent.currentY=a(e)}var c=this,u=function(i){t._activePointerEvent||(t._activePointerEvent=i,document.body.onmousemove=e,document.body.ontouchmove=n,t.clickHandlers.length&&t.clickHandlers.forEach(function(t){t.isActive&&t.callback(i)}))},h=function(){t._activePointerEvent=null,document.body.onmousemove=null,document.body.ontouchmove=null};document.body.onmousedown=function(t){u(l.fromMouseEvent(t))},document.body.ontouchstart=function(t){document.body.onmousedown=null,u(l.fromTouchEvent(t))},document.body.onmouseup=h,document.body.ontouchend=h,document.body.onkeydown=function(t){var e=t.keyCode||t.code,n=c.keyboardHandlers[e];n&&n.isActive&&!c.keyboardActivity[e]&&(c.keyboardActivity[e]=!0,n.callback(t));var i=c.keyboardHandlers[s.d.Any];i&&i.isActive&&!c.keyboardActivity[s.d.Any]&&(c.keyboardActivity[s.d.Any]=!0,i.callback(t))},document.body.onkeyup=function(t){var e=t.keyCode||t.code,n=c.keyboardHandlers[e];c.keyboardActivity[s.d.Any]=!1,n&&n.isActive&&(c.keyboardActivity[e]=!1)}},t.registerClickHandler=function(e){var n=new u(e);return t.clickHandlers.push(n),n},t.registerKeyHandler=function(e,n){var i=new u(n);return t.keyboardHandlers[e]=i,i},t.keyDown=function(t){return!!this.keyboardActivity[t]},t.clickHandlers=[],t.keyboardHandlers={},t.keyboardActivity={},t._activePointerEvent=null,t}(),u=function(){function t(t){this.callback=t,this.isAlive=!0,this.isAwake=!0}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this.isAlive&&this.isAwake},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.isAlive=!1},t.prototype.sleep=function(){this.isAwake=!1},t.prototype.wake=function(){this.isAwake=!0},t}(),l=function(){function t(){}return t.fromMouseEvent=function(t){var e=i(t),n=o(t);return{x:e,y:n,currentX:e,currentY:n}},t.fromTouchEvent=function(t){var e=r(t),n=a(t);return{x:e,y:n,currentX:e,currentY:n}},t}()},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return o});var i;!function(t){t[t.Opacity=0]="Opacity",t[t.Frame=1]="Frame",t[t.TileX=2]="TileX",t[t.TileY=3]="TileY"}(i||(i={}));var o=function(){function t(t){this.sprite=t,this.transformations={},this.depth=0,this._paused=!0,this.setTransform(i.Frame,0),this.setTransform(i.Opacity,1)}return Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},enumerable:!0,configurable:!0}),t.prototype.start=function(t,e,n){var o=this;this.stop(),this.setTransform(i.Frame,t),this._paused=!1,this.timer=setInterval(function(){o.getTransform(i.Frame)===e?o.setTransform(i.Frame,t):o.transform(i.Frame,1)},n)},t.prototype.stop=function(){this._paused=!0,this.timer&&clearInterval(this.timer)},t.prototype.setFrame=function(t){this.stop(),this.setTransform(i.Frame,t)},t.prototype.draw=function(t,e,n,o){void 0===o&&(o={});var r=this.getTransform(i.Frame);null!==o.frame&&void 0!==o.frame&&this.setTransform(i.Frame,o.frame);this.getTransform(i.Opacity);null!==o.frame&&void 0!==o.frame&&this.setTransform(i.Opacity,o.opacity);var a=this.sprite.getFrameImageSourceCoords(r),s=a[0],c=a[1];t.drawImage(this.sprite.image,s,c,e,n,this.sprite.width,this.sprite.height,o)},t.prototype.getTransform=function(t){return this.transformations[t]},t.prototype.transform=function(t,e){this.transformations[t]+=e},t.prototype.setTransform=function(t,e){this.transformations[t]=e},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Registry",function(){return i});var i=function(){function t(){}return t.get=function(t){return this.values[t]},t.load=function(t){return this.values[t]=localStorage.getItem(t),this.values[t]},t.set=function(t,e,n){void 0===n&&(n=!1),this.values[t]=e,n&&localStorage.setItem(t,e)},t.values={},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n(8),o=n(10),r=n(4),a=n(0),s=function(){return function(t,e,n,i){void 0===e&&(e="#000"),this.color=t,this.canvasColor=e,this.width=n,this.height=i}}(),c=function(){function t(t){this.name=t,this.actorInstanceMap={},this.propertyMap={},this.behaviors=[],this.eventHandlers=[]}return t.define=function(e){var n=new t(e);return a.Vastgame._getContext().defineRoom(e,n),n},t.get=function(t){return a.Vastgame._getContext().getRoom(t)},t.prototype.set=function(t,e){this.propertyMap[t]=e},t.prototype.get=function(t){return this.propertyMap[t]},t.prototype.setBackground=function(t,e,n,i){this.background=new s(t,i,e,n)},t.prototype.end=function(){this.actorInstanceMap={},this.behaviors=[],this.eventHandlers.forEach(function(t){return t.sleep()})},t.prototype.use=function(t){return this.behaviors.push(t),t},t.prototype.onStart=function(t){return this.onStartCallback=t,this},t.prototype._callStart=function(t){if(this.eventHandlers.forEach(function(t){return t.wake()}),this.onStartCallback)try{this.onStartCallback(this,t)}catch(t){throw"Room: "+this.name+".start"}},t.prototype.onDraw=function(t){return this.onDrawCallback=t,this},t.prototype._callDraw=function(t){if(this.onDrawCallback){var e=a.Vastgame._getContext().getCanvasContext();try{this.onDrawCallback(this,e,t)}catch(t){throw"Room: "+this.name+".draw"}}},t.prototype.onClick=function(t){var e=this,n=r.a.registerClickHandler(function(n){a.Vastgame._getContext().getCurrentRoom()===e&&t(e,n)});return this.eventHandlers.push(n),this},t.prototype.onKey=function(t,e){var n=this,i=r.a.registerKeyHandler(t,function(t){a.Vastgame._getContext().getCurrentRoom()===n&&e(n,t)});return this.eventHandlers.push(i),this},t.prototype.step=function(){var t=this;this.getInstances().forEach(function(e){var n=e.parent;e.isActive?(e._applyMovement(),t.checkCollisions(e),n._callStep(e)):(e.parent._callDestroy(e),delete t.actorInstanceMap[e.id])}),this.behaviors.forEach(function(e){return e.postStep(t)})},t.prototype.checkCollisions=function(t){var e=t.parent;for(var n in e.collisionHandlers)try{var o=e.collisionHandlers[n],r=i.a.get(n);for(var a in this.actorInstanceMap){var s=this.actorInstanceMap[a];s.parent===r&&t!==s&&t.collidesWith(s)&&o(t,s)}}catch(e){throw"Actor: "+this.name+"["+t.id+"].collision("+n+")"}},t.prototype.draw=function(t){var e=this;this.behaviors.forEach(function(n){return n.preDraw(e,t)}),this.background&&(t.fillArea(-this.background.width,-this.background.height,3*this.background.width,3*this.background.height,this.background.canvasColor),t.fill(this.background.width,this.background.height,this.background.color)),this.getInstances().sort(function(t,e){return(e.animation?e.animation.depth:0)-(t.animation?t.animation.depth:0)}).forEach(function(e){e.animation&&e.visible&&e.animation.draw(t,e.x,e.y),e.parent._callDraw(e)}),this._callDraw()},t.prototype.handleClick=function(t){this.behaviors.forEach(function(e){return e.preHandleClick(t)});var e=t.x,n=t.y;this.getInstancesAtPosition(e,n).forEach(function(i){var o=i.parent;i.occupiesPosition(e,n)&&o._callClick(i,t)}),this.behaviors.forEach(function(e){return e.postHandleClick(t)})},t.prototype.createActor=function(e,n,r){var a=i.a.get(e),s=t.nextActorInstanceID(),c=new o.a(this,a,s,n,r);return this.actorInstanceMap[s]=c,a._callCreate(c),c},t.prototype.getInstance=function(t){return this.getInstances([t])[0]},t.prototype.getInstances=function(t){void 0===t&&(t=[]);var e=[];for(var n in this.actorInstanceMap){var i=this.actorInstanceMap[n];(!t.length||t&&t.indexOf(i.parent)>-1)&&e.push(this.actorInstanceMap[n])}return e},t.prototype.getInstancesAtPosition=function(t,e){return this.getInstances().filter(function(n){return n.occupiesPosition(t,e)})},t.prototype.isPositionFree=function(t,e,n){return n&&n.length?!this.getInstancesAtPosition(t,e).filter(function(t){return-1!==n.indexOf(t.parent)}).length:!this.getInstancesAtPosition(t,e).length},t.nextActorInstanceID=function(){var t=0;return function(){return++t}}(),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(9),o=n(0),r=function(){function t(t,e){void 0===e&&(e={}),this.collisionHandlers={},this.actorEventHandlers={},this.name=t,this.sprite=e.sprite,e.boundary?this.boundary=e.boundary:e.sprite&&(this.boundary=i.a.fromSprite(e.sprite))}return t.define=function(e,n){var i=new t(e,n);return o.Vastgame._getContext().defineActor(e,i),i},t.get=function(t){return o.Vastgame._getContext().getActor(t)},t.prototype.setGameContextEventArgs=function(t){t.game={currentRoom:o.Vastgame._getContext().getCurrentRoom()}},t.prototype.onCreate=function(t){return this.onCreateCallback=t,this},t.prototype._callCreate=function(t){if(this.onCreateCallback)try{this.onCreateCallback(t)}catch(e){throw"Actor: "+t.parent.name+"["+t.id+"].create"}},t.prototype.onStep=function(t){return this.onStepCallback=t,this},t.prototype._callStep=function(t){if(this.onStepCallback)try{this.onStepCallback(t)}catch(e){throw"Actor: "+t.parent.name+"["+t.id+"].step"}t.previousX=t.x,t.previousY=t.y},t.prototype.onDraw=function(t){return this.onDrawCallback=t,this},t.prototype._callDraw=function(t){if(this.onDrawCallback){var e=o.Vastgame._getContext().getCanvasContext();try{this.onDrawCallback(t,e)}catch(e){throw"Actor: "+t.parent.name+"["+t.id+"].draw"}}},t.prototype.onClick=function(t){return this.onClickCallback=t,this},t.prototype._callClick=function(t,e){if(this.onClickCallback)try{this.onClickCallback(t,e)}catch(e){throw"Actor: "+t.parent.name+"["+t.id+"].click"}},t.prototype.onDestroy=function(t){return this.onDestroyCallback=t,this},t.prototype._callDestroy=function(t){if(this.onDestroyCallback)try{this.onDestroyCallback(t)}catch(e){throw"Actor: "+t.parent.name+"["+t.id+"].destroy"}},t.prototype.onCollide=function(t,e){return this.collisionHandlers[t]=e,this},t.prototype.onEvent=function(t,e){return this.actorEventHandlers[t]=e,this},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=function(){function t(t,e,n){this.x=t,this.y=e,this.height=n.height,this.width=n.width}return t.prototype.collidesWith=function(t){return!(this.x>t.x+t.width||t.x>=this.x+this.width)&&!(this.y>t.y+t.height||t.y>=this.y+this.height)},t.prototype.containsPosition=function(t,e){return!(this.x>t||t>this.x+this.width)&&!(this.y>e||e>this.y+this.height)},t}(),o=function(){function t(t,e,n){if(void 0===n&&(n=!1),this.height=t,this.width=e,this.solid=n,t<=0||e<=0)throw new Error("Height and width must both be greater than zero.")}return t.fromSprite=function(e,n){return void 0===n&&(n=!1),new t(e.height,e.width,n)},t.prototype.atPosition=function(t,e){return new i(t,e,this)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n(1),o=n(19),r=n(5),a=n(20),s=function(){function t(t,e,n,o,a){void 0===o&&(o=0),void 0===a&&(a=0),this.room=t,this.parent=e,this.id=n,this.x=o,this.y=a,this.speed=0,this.direction=0,this.visible=!0,this.state=i.a.Active,this.parent.sprite&&(this.spriteAnimation=new r.a(this.parent.sprite))}return Object.defineProperty(t.prototype,"hasMoved",{get:function(){return this.x!==this.previousX||this.y!==this.previousY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state===i.a.Active},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boundary",{get:function(){return this.parent.boundary},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this.spriteAnimation},enumerable:!0,configurable:!0}),t.prototype.raiseEvent=function(t,e){this.raiseEventWhen(t,function(){return!0},e)},t.prototype.raiseEventIn=function(t,e,n){var i=this;setTimeout(function(){i.raiseEvent(t,n)},e)},t.prototype.raiseEventWhen=function(t,e,n){void 0===n&&(n={}),this.parent.setGameContextEventArgs(n);var i=this.parent.actorEventHandlers[t];if(!i)throw new Error("Attempting to raise undefined Event: "+t);o.a.register(new o.a(e,i.bind(null,this,n)))},t.prototype.collidesWith=function(t){return!!(this.hasMoved&&this.boundary&&t.boundary)&&this.boundary.atPosition(this.x,this.y).collidesWith(t.boundary.atPosition(t.x,t.y))},t.prototype.setPositionRelative=function(t,e){this.setPosition(this.x+t,this.y+e)},t.prototype.setPosition=function(t,e){this.previousX=this.x,this.previousY=this.y,this.x=t,this.y=e},t.prototype.move=function(t,e){this.speed=t,this.direction=e},t.prototype._applyMovement=function(){if(0!==this.speed){var t=Math.round(a.a.getLengthDirectionX(100*this.speed,this.direction)/100),e=Math.round(a.a.getLengthDirectionY(100*this.speed,this.direction)/100);0===t&&0===e||this.setPositionRelative(t,e)}},t.prototype.occupiesPosition=function(t,e){return!!this.boundary&&this.boundary.atPosition(this.x,this.y).containsPosition(t,e)},t.prototype.destroy=function(){this.state=i.a.Destroyed},t}()},function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a});var i=n(1),o=function(){function t(t,e,n){this.grid=t,this.x=e,this.y=n}return t.prototype.getCell=function(){var t=this.x-this.x%this.grid.tileSize,e=this.y-this.y%this.grid.tileSize;return new r(this.grid,t,e)},t}(),r=function(){function t(t,e,n){this.grid=t,this.x=e,this.y=n}return Object.defineProperty(t.prototype,"size",{get:function(){return this.grid.tileSize},enumerable:!0,configurable:!0}),t.prototype.getAdjacentCell=function(e){var n=0,o=0;switch(e){case i.b.Down:o=this.grid.tileSize;break;case i.b.Left:n=-this.grid.tileSize;break;case i.b.Right:n=this.grid.tileSize;break;case i.b.Up:o=-this.grid.tileSize}return new t(this.grid,this.x+n,this.y+o)},t.prototype.getContents=function(){return this.grid.room.getInstancesAtPosition(this.x+this.grid.tileSize/2,this.y+this.grid.tileSize/2)},t.prototype.containsInstance=function(t){return this.getContents().some(function(e){return e===t})},t.prototype.containsInstanceOf=function(t){return t.length?this.getContents().some(function(e){return t.indexOf(e.parent)>-1}):this.getContents().some(function(e){return e.parent===t})},t.prototype.isFree=function(t){return t&&t.length?!this.getContents().filter(function(e){return-1!==t.indexOf(e.parent)}).length:!this.getContents().length},t}(),a=function(){function t(t,e){this.tileSize=t,this.room=e}return t.prototype.getCellAtPosition=function(t,e){return new r(this,t,e)},t.prototype.find=function(t){var e=this.room.getInstances();if(e&&e.length){var n=e.find(function(e){return e.parent===t});return new r(this,n.x,n.y)}return null},t.prototype.onClick=function(t){this._onClick=t},t.prototype.raiseClickEvent=function(t,e){var n=new o(this,t,e);this._onClick(n)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i;!function(t){t[t.SamePosition=1]="SamePosition",t[t.Center=2]="Center"}(i||(i={}));var o=function(){function t(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i,this.attachments=[],this.offsetX=0,this.offsetY=0}return t.prototype.follow=function(t,e,n,o){void 0===e&&(e=!1),void 0===n&&(n=0),void 0===o&&(o=0),this.viewMode=e?i.Center:i.SamePosition,this.followInstance=t,this.offsetX=n,this.offsetY=o},t.prototype.attach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),this.attachments.push(new r(this,t,e,n))},t.prototype.update=function(){this.followInstance&&(this.viewMode===i.Center?this.centerAroundBoundary(this.followInstance.boundary):(this.x=this.offsetX+this.followInstance.x||0,this.y=this.offsetY+this.followInstance.y||0),this.attachments.forEach(function(t){return t.update()}))},t.prototype.centerAroundBoundary=function(t){if(!t)throw new Error("boundary is "+t);this.x=this.offsetX+(this.followInstance.x+t.width/2-this.width/2),this.y=this.offsetY+(this.followInstance.y+t.height/2-this.height/2)},t}(),r=function(){function t(t,e,n,i){this.parent=t,this.instance=e,this.offsetX=n,this.offsetY=i}return t.prototype.update=function(){this.instance.x=this.parent.x+this.offsetX,this.instance.y=this.parent.y+this.offsetY},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.requireModules=function(t,e){e.forEach(function(e){return n(31)("./"+t+"/"+e)})},e.buildCanvasDimensions=function(){var t=window.innerWidth<i.CanvasMaxWidth,e=t?window.innerWidth:i.CanvasMaxWidth;e+=e%2==0?0:1;var n=t?window.innerHeight:i.CanvasMaxHeight;return n+=n%2==0?0:1,[e,n]},e.getDigitDrawInstances=function(t,e){void 0===e&&(e=!1);var n=Math.floor(i.GridCellSize/4),o=Math.floor(n/2)-3,r=Math.floor(2*n)-3,a=e?10:0,s=[];return t<10?s.push({x:n,y:n,frame:a+t}):(s.push({x:o,y:n,frame:a+Math.floor(t/10)}),s.push({x:r,y:n,frame:a+t%10})),s};var i=n(3),o=n(6);n.d(e,"Registry",function(){return o.Registry})},function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a});var i=n(11),o=n(12),r=function(){function t(t,e,n,i){this.view=new o.a(t,e,n,i)}return t.prototype.getView=function(){return this.view},t.prototype.preHandleClick=function(t){var e=this.getOffset(),n=e[0],i=e[1];t.x+=n,t.y+=i},t.prototype.postStep=function(t){this.view.update()},t.prototype.preDraw=function(t,e){var n=this.getOffset(),i=n[0],o=n[1];e.origin=[-i,-o]},t.prototype.postHandleClick=function(t){},t.prototype.getOffset=function(){return[this.view?this.view.x:0,this.view?this.view.y:0]},t}(),a=function(){function t(t,e){this.grid=new i.a(t,e)}return t.prototype.getGrid=function(){return this.grid},t.prototype.postHandleClick=function(t){this.grid.raiseClickEvent(t.x,t.y)},t.prototype.preHandleClick=function(t){},t.prototype.postStep=function(t){},t.prototype.preDraw=function(t,e){},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Levels",function(){return i});var i=function(){function t(){}return Object.defineProperty(t,"count",{get:function(){var t=0;for(var e in this.levels)t++;return t},enumerable:!0,configurable:!0}),t.get=function(t){return this.levels[t]},t.levels={1:["################","#              #","#              #","#              #","#X        #    #","### P  #  #  W #","################"],2:["#################","#               #","#               #","#          #    #","#XX        #    #","#### P   # #  W #","#################"],3:["################","#              #","#              #","#         #    #","#XX       #    #","###X  P   #  W #","################"],4:["################","#              #","#              #","#X        #  W #","#XX       #  ###","###X  P   #  ###","################"],5:["################","#       #      #","#       #    W #","#            ###","#X      #      #","#XX P   #X   XX#","################"],6:["##################","#                #","#              W #","#              ###","#        X     ###","#X       #    X###","#XX P #      XX###","##################"],7:["##################","#               W#","#               ##","#       ######  ##","#XX          #####","#######          #","#          #    X#","#XX P      #   XX#","##################"],8:["##############","#W           #","##           #","##P          #","### X      XX#","#####    #####","#####        #","#####      XX#","##############"],9:["###################","#                 #","#     X         W #","#    # #    X #####","# P ## ##  #  #####","###### ############","###################"],10:["#####################","###############    ##","##############   # ##","###              # ##","##      X   P   ## ##","#     ############ ##","#        ######### ##","#X    XXX######### ##","################## ##","##############     ##","#########    # ######","######### #      ####","######### #         #","######### ######    #","######### ##       ##","######### ##XXX  ####","######### ###########","#########         W##","#####################"]},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(t){this.canvasElement=t,this.gameCanvasContext=new o(this.canvasElement)}return t.prototype.getContext=function(){return this.gameCanvasContext},t.prototype.init=function(t){this.canvasElement&&(this.canvasElement.height=t.height,this.canvasElement.width=t.width)},t}(),o=function(){function t(t){this.canvasElement=t,this.origin=[0,0]}return Object.defineProperty(t.prototype,"canvasContext2D",{get:function(){return this.canvasElement.getContext("2d")},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this.canvasContext2D.clearRect(0,0,this.canvasElement.width,this.canvasElement.height)},t.prototype.fill=function(t,e,n){var i=this.origin,o=i[0],r=i[1];this.fillArea(o,r,t,e,n)},t.prototype.fillArea=function(t,e,n,i,o){this.canvasContext2D.beginPath(),this.canvasContext2D.rect(t,e,n,i),this.canvasContext2D.fillStyle=o,this.canvasContext2D.fill()},t.prototype.drawImage=function(t,e,n,i,o,r,a,s){void 0===s&&(s={});var c=null;1!==s.opacity&&null!==s.opacity&&void 0!==s.opacity&&(c=this.canvasContext2D.globalAlpha,this.canvasContext2D.globalAlpha=s.opacity);var u=this.origin,l=u[0],h=u[1];if(s.tileX||s.tileY){var f=s.tileX&&s.tileY?"repeat":s.tileX?"repeat-x":"repeat-y",p=this.canvasContext2D.createPattern(t,f);this.canvasContext2D.fillStyle=p,this.canvasContext2D.fillRect(l+i,h+o,this.canvasContext2D.canvas.width,this.canvasContext2D.canvas.height)}else this.canvasContext2D.drawImage(t,e,n,r,a,Math.floor(l+i),Math.floor(h+o),r,a);null!==c&&(this.canvasContext2D.globalAlpha=c)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n(4),o=function(){function t(t){this.canvas=t,this.actors={},this.events={},this.rooms={},this.sprites={},this.nextEventID=function(){var t=0;return function(){return++t}}()}return t.prototype.getCanvasContext=function(){return this.canvas.getContext()},t.prototype.defineActor=function(t,e){if(this.actors[t])throw new Error("Actor "+t+" has already been defined.");this.actors[t]=e},t.prototype.getActor=function(t){if(!this.actors[t])throw new Error("Actor "+t+" has not been defined.");return this.actors[t]},t.prototype.registerEvent=function(t){this.events[this.nextEventID()]=t},t.prototype.checkAndFireEvents=function(){for(var t in this.events){var e=this.events[t];e.conditionCallback()&&(e.actionCallback(),e.fireOnce&&delete this.events[t])}},t.prototype.defineRoom=function(t,e){if(this.rooms[t])throw new Error("Room "+t+" has already been defined.");this.rooms[t]=e},t.prototype.getRoom=function(t){if(!this.rooms[t])throw new Error("Room "+t+" has not been defined.");return this.rooms[t]},t.prototype.getCurrentRoom=function(){return this.currentRoom},t.prototype.setCurrentRoom=function(t){this.currentRoom=t,this.currentRoomClickHandler&&this.currentRoomClickHandler.dispose(),this.currentRoomClickHandler=i.a.registerClickHandler(function(e){return t.handleClick(e)})},t.prototype.defineSprite=function(t,e){if(this.sprites[t])throw new Error("Sprite "+t+" has already been defined.");this.sprites[t]=e},t.prototype.getSprite=function(t){if(!this.sprites[t])throw new Error("Sprite "+t+" has not been defined.");return this.sprites[t]},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(1),o=60,r=function(){function t(t){this.options=t,this.state=i.c.Paused,this.targetFPS=t.targetFPS||o}return Object.defineProperty(t.prototype,"isRunning",{get:function(){return this.state===i.c.Running},enumerable:!0,configurable:!0}),t.prototype.pause=function(){this.state=i.c.Paused},t.prototype.start=function(t){var e=this,n=1/this.targetFPS,o=0,r=window.performance.now(),a=t.getCanvasContext(),s=function(){var i=t.getCurrentRoom(),c=window.performance.now();for(o+=Math.min(1,(c-r)/1e3);o>n;){if(!e.isRunning)return;t.checkAndFireEvents(),i.step(),o-=n}e.isRunning&&(a.clear(),i.draw(a)),r=c,requestAnimationFrame(s)};this.state=i.c.Running,requestAnimationFrame(s)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var i=n(0),o=function(){function t(t,e,n){void 0===n&&(n=!0),this.conditionCallback=t,this.actionCallback=e,this.fireOnce=n}return t.register=function(t){i.Vastgame._getContext().registerEvent(t)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i=function(){function t(){}return t.getLengthDirectionX=function(t,e){return t*Math.cos(e*(Math.PI/180))},t.getLengthDirectionY=function(t,e){return t*Math.sin(e*(Math.PI/180))},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(5),o=n(0),r=function(){function t(t){this.image=new Image,this.image.src=t.imageSource,this.height=t.height,this.width=t.width,this.frameBorder=t.frameBorder,this.defaultAnimation=new i.a(this)}return t.define=function(e,n){var i=new t(n);return o.Vastgame._getContext().defineSprite(e,i),i},t.get=function(t){return o.Vastgame._getContext().getSprite(t)},t.prototype.draw=function(t,e,n,i){void 0===i&&(i={}),this.defaultAnimation.setFrame(i.frame||0),this.defaultAnimation.draw(t,e,n,i)},t.prototype.getFrameImageSourceCoords=function(t){var e=this.frameBorder||0,n=0;if(this.image.width)for(var i=Math.floor(this.image.width/this.width);this.width*t>=i*this.width;)t-=i,n++;var o=t*e,r=n*e;return[t*this.width+o,n*this.height+r]},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(2),r=n(13),a=Object(r.buildCanvasDimensions)(),s=a[0],c=a[1];r.Registry.set(o.Settings.CanvasWidth,s),r.Registry.set(o.Settings.CanvasHeight,c),i.Vastgame.init("game",{canvas:{width:s,height:c}}),n(24),Object(r.requireModules)("actors",["block","player","win"]),Object(r.requireModules)("rooms",["level","level-select","title"]),r.Registry.load(o.Settings.StackmoProgress),r.Registry.set(o.Settings.StackmoProgress,99,!0),i.Vastgame.start(o.RoomID.Title)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"LevelBuilder",function(){return c});var i,o=n(0),r=n(2),a=n(3),s=n(15),c=function(){function t(){}return t.populateRoom=function(t,e){var n=a.GridCellSize,i=(o.Actor.get("Block"),o.Actor.get("Player"),o.Actor.get("Wall"),o.Actor.get("Win"),[]),c=s.Levels.get(e),u={0:[r.LevelBgColor.Teal,r.LevelBgColor.DarkTeal],1:[r.LevelBgColor.Green,r.LevelBgColor.DarkGreen],2:[r.LevelBgColor.Red,r.LevelBgColor.DarkRed],3:[r.LevelBgColor.Purple,r.LevelBgColor.DarkPurple]},l=(e-1)%4;t.setBackground(u[l][0],c[0].length*n,c.length*n,u[l][1]);for(var h=0;h<c.length;h++)for(var f=c[h],p=0;p<f.length;p++)switch(f.charAt(p)){case"X":i.push(t.createActor(r.ActorID.Block,p*n,h*n));break;case"P":i.push(t.createActor(r.ActorID.Player,p*n,h*n));break;case"W":i.push(t.createActor(r.ActorID.Win,p*n,h*n));break;case"#":var d=t.createActor(r.ActorID.Wall,p*n,h*n),g=this.getWallFrame(c,e,h,p);g=this.getWallFrameRowOffeset(l,g),d.animation.setFrame(g),i.push(d)}return i},t.getWallFrameRowOffeset=function(t,e){return e+45*t},t.getWallFrame=function(t,e,n,o){var r=t[0].length-1,a=t.length-1,s=n>0&&"#"!==t[n-1][o],c=n>0&&o>0&&"#"!==t[n-1][o-1],u=n>0&&o<r&&"#"!==t[n-1][o+1],l=n<a&&"#"!==t[n+1][o],h=n<a&&o>0&&"#"!==t[n+1][o-1],f=n<a&&o<r&&"#"!==t[n+1][o+1],p=o>0&&"#"!==t[n][o-1],d=o<r&&"#"!==t[n][o+1];return s||c||u||p||d||h||l||f?s||c||u||p||d||h||l?s||c||u||p||d||l||f?s||c||p||d||h||l||f?s||u||p||d||h||l||f?s||c||p||h||l||d?s||u||d||f||l||p?p||h||l||f||d||s?p||c||s||u||d||l?s||c||p||h||l?s||u||d||f||l?p||h||l||f||d?p||c||s||u||d?s||p||l||d||f?s||p||l||d||h?s||p||l||d||u?s||p||l||d||c?s||p||l||d?p||d||f||l?p||d||h||l?p||d||u||s?p||d||c||s?s||d||f||l?s||p||h||l?l||d||u||s?l||p||c||s?d||f||l?p||h||l?d||u||s?p||c||s?s||l||p?s||l||d?s||p||d?p||d||l?p||d?s||l?s||p?s||d?l||p?l||d?s?p?l?d?i.Solo:i.CappedLeft:i.CappedTop:i.CappedRight:i.CappedBottom:i.OuterElbowTopLeft:i.OuterElbowTopRight:i.OuterElbowBottomLeft:i.OuterElbowBottomRight:i.NarrowVertical:i.NarrowHorizontal:i.ThreewayNarrowBottom:i.ThreewayNarrowTop:i.ThreewayNarrowRight:i.ThreewayNarrowLeft:i.OuterCornerBottomRight:i.OuterCornerBottomLeft:i.OuterCornerTopRight:i.OuterCornerTopLeft:i.FlatRightNarrowBottom:i.FlatLeftNarrowBottom:i.FlatRightNarrowTop:i.FlatLeftNarrowTop:i.FlatBottomNarrowRight:i.FlatBottomNarrowLeft:i.FlatTopNarrowRight:i.FlatTopNarrowLeft:i.Fourway:i.TwoWayBottomRight:i.TwoWayBottomLeft:i.TwoWayTopRight:i.TwoWayTopLeft:i.FlatTop:i.FlatBottom:i.FlatRight:i.FlatLeft:i.ThreewayBottom:i.ThreewayTop:i.ThreewayLeft:i.ThreewayRight:i.InnerCornerBottomRight:i.InnerCornerBottomLeft:i.InnerCornerTopRight:i.InnerCornerTopLeft:i.Inner},t}();!function(t){t[t.InnerCornerTopLeft=0]="InnerCornerTopLeft",t[t.FlatTop=1]="FlatTop",t[t.InnerCornerTopRight=2]="InnerCornerTopRight",t[t.OuterCornerTopLeft=3]="OuterCornerTopLeft",t[t.OuterCornerBottomLeft=4]="OuterCornerBottomLeft",t[t.FlatLeft=5]="FlatLeft",t[t.Inner=6]="Inner",t[t.FlatRight=7]="FlatRight",t[t.OuterCornerTopRight=8]="OuterCornerTopRight",t[t.InnerCornerBottomLeft=9]="InnerCornerBottomLeft",t[t.FlatBottom=10]="FlatBottom",t[t.InnerCornerBottomRight=11]="InnerCornerBottomRight",t[t.OuterCornerBottomRight=12]="OuterCornerBottomRight",t[t.NarrowHorizontal=13]="NarrowHorizontal",t[t.NarrowVertical=14]="NarrowVertical",t[t.CappedLeft=15]="CappedLeft",t[t.CappedTop=16]="CappedTop",t[t.CappedRight=17]="CappedRight",t[t.CappedBottom=18]="CappedBottom",t[t.ThreewayNarrowTop=19]="ThreewayNarrowTop",t[t.ThreewayNarrowRight=20]="ThreewayNarrowRight",t[t.ThreewayNarrowBottom=21]="ThreewayNarrowBottom",t[t.ThreewayNarrowLeft=22]="ThreewayNarrowLeft",t[t.Fourway=23]="Fourway",t[t.Solo=24]="Solo",t[t.ThreewayTop=25]="ThreewayTop",t[t.ThreewayRight=26]="ThreewayRight",t[t.ThreewayBottom=27]="ThreewayBottom",t[t.ThreewayLeft=28]="ThreewayLeft",t[t.FlatTopNarrowLeft=29]="FlatTopNarrowLeft",t[t.FlatTopNarrowRight=30]="FlatTopNarrowRight",t[t.FlatBottomNarrowLeft=31]="FlatBottomNarrowLeft",t[t.FlatBottomNarrowRight=32]="FlatBottomNarrowRight",t[t.FlatLeftNarrowTop=33]="FlatLeftNarrowTop",t[t.FlatRightNarrowTop=34]="FlatRightNarrowTop",t[t.FlatLeftNarrowBottom=35]="FlatLeftNarrowBottom",t[t.FlatRightNarrowBottom=36]="FlatRightNarrowBottom",t[t.TwoWayTopLeft=37]="TwoWayTopLeft",t[t.TwoWayTopRight=38]="TwoWayTopRight",t[t.TwoWayBottomLeft=39]="TwoWayBottomLeft",t[t.TwoWayBottomRight=40]="TwoWayBottomRight",t[t.OuterElbowBottomLeft=41]="OuterElbowBottomLeft",t[t.OuterElbowBottomRight=42]="OuterElbowBottomRight",t[t.OuterElbowTopLeft=43]="OuterElbowTopLeft",t[t.OuterElbowTopRight=44]="OuterElbowTopRight"}(i||(i={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),r=n(2);i.Sprite.define(r.SpriteID.ArrowSheet,{imageSource:"../resources/arrows.png",height:o.GridCellSize,width:o.GridCellSize}),i.Sprite.define(r.SpriteID.Box,{imageSource:"../resources/box.png",height:o.GridCellSize,width:o.GridCellSize}),i.Sprite.define(r.SpriteID.Digits,{imageSource:"../resources/digits_sheet.png",height:o.GridCellSize/2,width:o.GridCellSize/2}),i.Sprite.define(r.SpriteID.DoorSheet,{imageSource:"../resources/door_sheet.png",height:o.GridCellSize,width:32,frameBorder:1}),i.Sprite.define(r.SpriteID.ExitButton,{imageSource:"../resources/exit_button.png",height:o.GridCellSize,width:o.GridCellSize}),i.Sprite.define(r.SpriteID.LevelIcon,{imageSource:"../resources/level_icon.png",width:o.GridCellSize,height:o.GridCellSize}),i.Sprite.define(r.SpriteID.HUD,{imageSource:"../resources/hud.png",height:o.GridCellSize,width:o.GridCellSize}),i.Sprite.define(r.SpriteID.StackmoSheet,{imageSource:"../resources/stackmo_sheet.png",height:o.GridCellSize,width:o.GridCellSize,frameBorder:4}),i.Sprite.define(r.SpriteID.Title,{imageSource:"../resources/title.png",width:o.TitleWidth,height:o.TitleHeight}),i.Sprite.define(r.SpriteID.Wall,{imageSource:"../resources/wall_sheet.png",height:o.GridCellSize,width:o.GridCellSize,frameBorder:1})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),r=n(2);i.Actor.define(r.ActorID.Block,{sprite:i.Sprite.get(r.SpriteID.Box)}).onEvent(r.GameAction.Fall,function(t,e){if(e.game.currentRoom.isPositionFree(t.x+1,t.y+o.GridCellSize+1)){var n=t.y;e.targetCell=e.targetCell.getAdjacentCell(i.Direction.Down),t.move(o.BlockFallSpeed,i.Direction.Down),t.raiseEventWhen(r.GameAction.Stop,function(){return Math.abs(n-t.y)>=o.GridCellSize},e)}}).onEvent(r.GameAction.Stop,function(t,e){var n=e.game.currentRoom,i=e.targetCell;t.move(0),t.setPosition(i.x,i.y),n.isPositionFree(t.x+1,t.y+o.GridCellSize+1)&&t.raiseEvent(r.GameAction.Fall,e)})},function(t,e,n){"use strict";function i(t,e,n){void 0===n&&(n=!1);var i=f.StackmoFrame.StandRight;i=a?e===l.Direction.Right?f.StackmoFrame.StandHoldRight:f.StackmoFrame.StandHoldLeft:e===l.Direction.Right?f.StackmoFrame.StandRight:f.StackmoFrame.StandLeft,n?t.animation.start(i+1,i+2,100):t.animation.setFrame(i)}function o(){return l.Input.clickActive||l.Input.keyDown(s===l.Direction.Left?l.Key.Left:l.Key.Right)}function r(t){return(l.Input.clickActive?l.Input.activePointerEvent.currentX||0:0)+(t.behaviors.find(function(t){return!!t.view}).view.x||0)}Object.defineProperty(e,"__esModule",{value:!0});var a,s,c,u,l=n(0),h=n(3),f=n(2);l.Actor.define(f.ActorID.Player,{sprite:l.Sprite.get(f.SpriteID.StackmoSheet)}).onCreate(function(t){t.animation.depth=-50,s=l.Direction.Right,a=null,c=[l.Actor.get(f.ActorID.Block),l.Actor.get(f.ActorID.Wall)],u=l.Actor.get(f.ActorID.Win)}).onStep(function(t){a&&a.setPosition(t.x,t.y-h.GridCellSize)}).onEvent(f.GameAction.Move,function(t,e){var n=e.targetCell,o=e.direction,r=t.x;s=o,(!a||a&&n.getAdjacentCell(l.Direction.Up).isFree())&&(t.move(h.PlayerMoveSpeed,o),t.raiseEventWhen(f.GameAction.CheckStopMoving,function(){return Math.abs(r-t.x)>=h.GridCellSize},e),i(t,o,!0))}).onEvent(f.GameAction.CheckStopMoving,function(t,e){var n=e.targetCell,i=f.GameAction.Stop;if(t.move(0),t.setPosition(n.x,n.y),o()&&!n.containsInstanceOf(u)&&!n.getAdjacentCell(l.Direction.Down).isFree(c)){if(l.Input.clickActive){var a=r(e.game.currentRoom);e.direction=a<=t.x+n.size/2?l.Direction.Left:l.Direction.Right}var s=n.getAdjacentCell(e.direction);s.isFree(c)?(e.targetCell=s,i=f.GameAction.Move):s.getAdjacentCell(l.Direction.Up).isFree(c)&&(e.targetCell=s.getAdjacentCell(l.Direction.Up),i=f.GameAction.Jump)}t.raiseEvent(i,e)}).onEvent(f.GameAction.Fall,function(t,e){var n=t.y,o=e.direction;e.targetCell=e.targetCell.getAdjacentCell(l.Direction.Down),t.move(h.PlayerFallSpeed,l.Direction.Down),t.raiseEventWhen(f.GameAction.StopFalling,function(){return Math.abs(n-t.y)>=h.GridCellSize},e),i(t,o,!1)}).onEvent(f.GameAction.StopFalling,function(t,e){var n=e.targetCell;t.move(0),t.setPosition(e.targetCell.x,e.targetCell.y),o()&&!n.getAdjacentCell(l.Direction.Down).isFree(c)?(e.targetCell=n.getAdjacentCell(e.direction),e.targetCell.isFree(c)&&t.raiseEvent(f.GameAction.Move,e)):t.raiseEvent(f.GameAction.Stop,e)}).onEvent(f.GameAction.Stop,function(t,e){var n=e.game.currentRoom,o=e.targetCell;if(t.move(0),t.setPosition(o.x,o.y),i(t,s,!1),n.isPositionFree(t.x+1,t.y+h.GridCellSize+1,c))t.raiseEvent(f.GameAction.Fall,e);else{var r=l.Actor.get(f.ActorID.Win);o.containsInstanceOf(r)&&n.getInstance(r).raiseEvent(f.GameAction.Win)}}).onEvent(f.GameAction.Jump,function(t,e){var n=e.targetCell,i=e.direction,o=t.y,r=n.getAdjacentCell(i===l.Direction.Right?l.Direction.Left:l.Direction.Right),s=a?r.getAdjacentCell(l.Direction.Up):null;if(s?s.isFree()&&s.getAdjacentCell(i).isFree():r.isFree()){t.move(h.PlayerJumpSpeed,l.Direction.Up),t.raiseEventWhen(f.GameAction.Move,function(){return Math.abs(o-t.y)>=h.GridCellSize},e)}}).onEvent(f.GameAction.Lift,function(t,e){var n=e.block,o=e.targetCell,r=o.x<t.x?l.Direction.Left:l.Direction.Right,c=o.y!==t.y||Math.abs(o.x-t.x)>70,u=o.getAdjacentCell(l.Direction.Up),h=u.getAdjacentCell(r===l.Direction.Left?l.Direction.Right:l.Direction.Left),p=!(u.isFree()&&h.isFree());a&&n===a?t.raiseEvent(f.GameAction.Drop,e):a||p||c||(a=n,i(t,s,!1),t.raiseEvent(f.GameAction.Turn,{direction:r}))}).onEvent(f.GameAction.Drop,function(t,e){var n=e.block,o=e.targetCell,r=s===l.Direction.Left?-h.GridCellSize:h.GridCellSize;o.getAdjacentCell(s).isFree()&&(e.targetCell=e.targetCell.getAdjacentCell(s),a=null,n.setPositionRelative(r,0),n.raiseEvent(f.GameAction.Fall,e),i(t,s,!1))}).onEvent(f.GameAction.Turn,function(t,e){var n=e.direction;i(t,s=n,!1)})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(2),r=!1,a=!1,s=0;i.Actor.define(o.ActorID.Win,{sprite:i.Sprite.get(o.SpriteID.DoorSheet)}).onCreate(function(t){t.animation.depth=-10,t.visible=!1}).onDraw(function(t,e){var n=i.Sprite.get(o.SpriteID.DoorSheet);n.draw(e,t.x-s,t.y,{frame:0}),n.draw(e,t.x+32+s,t.y,{frame:1})}).onStep(function(t){r?s++:a&&s--}).onEvent(o.GameAction.Win,function(t,e){e.game.currentRoom.set("complete",!0),t.raiseEvent("open")}).onEvent("open",function(t,e){r=!0,t.raiseEventIn("stopOpening",500,e)}).onEvent("stopOpening",function(t,e){r=!1,t.animation.depth=-100,t.raiseEventIn("startClosing",500,e)}).onEvent("startClosing",function(t,e){a=!0,t.raiseEventIn("stopClosing",500,e)}).onEvent("stopClosing",function(t,e){s=0,a=!1,t.raiseEventIn("exitLevel",500,e)}).onEvent("exitLevel",function(t,e){i.Vastgame.setRoom(o.RoomID.LevelSelect,{win:!0})})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),r=n(2),a=n(6),s=n(14),c=n(13);i.Actor.define(r.ActorID.ExitButton,{boundary:new i.Boundary(o.GridCellSize,o.GridCellSize)}).onClick(function(){i.Vastgame.setRoom(r.RoomID.LevelSelect)}),i.Actor.define(r.ActorID.Wall,{sprite:i.Sprite.get(r.SpriteID.Wall)});var u,l,h,f,p=i.Actor.get(r.ActorID.Player),d=i.Actor.get(r.ActorID.Wall),g=a.Registry.get(r.Settings.CanvasWidth),v=a.Registry.get(r.Settings.CanvasHeight);i.Room.define(r.RoomID.Level).onStart(function(t,e){u=e.levelNumber,t.set("complete",!1),f=i.Actor.get(r.ActorID.Block),p=i.Actor.get(r.ActorID.Player),d=i.Actor.get(r.ActorID.Wall);var n=new s.a(o.GridCellSize,t);l=n.getGrid(),t.use(n);var a=t.getInstances().find(function(t){return t.parent===p}),c=new i.ViewedRoomBehavior(0,0,g,v);t.use(c),(h=c.getView()).follow(a,!0,0,-o.GridCellSize/2),h.attach(t.createActor(r.ActorID.ExitButton));i.Sprite.get(r.SpriteID.HUD),i.Sprite.get(r.SpriteID.ExitButton),i.Sprite.get(r.SpriteID.Digits);l.onClick(function(t){if(!l.room.get("complete")&&!a.speed){var e=t.getCell(),n=l.find(p);if(e.containsInstanceOf(f))a.raiseEvent(r.GameAction.Lift,{block:e.getContents()[0],targetCell:e});else if(e.x<n.x){var o=n.getAdjacentCell(i.Direction.Left),s=o.getAdjacentCell(i.Direction.Up);o.isFree([f,d])?a.raiseEvent(r.GameAction.Move,{direction:i.Direction.Left,targetCell:o}):o.containsInstanceOf([f,d])&&s.isFree()?a.raiseEvent(r.GameAction.Jump,{direction:i.Direction.Left,targetCell:s}):a.raiseEvent(r.GameAction.Turn,{direction:i.Direction.Left})}else if(e.x>n.x){var c=n.getAdjacentCell(i.Direction.Right),u=c.getAdjacentCell(i.Direction.Up);c.isFree([f,d])?a.raiseEvent(r.GameAction.Move,{direction:i.Direction.Right,targetCell:c}):c.containsInstanceOf([f,d])&&u.isFree()?a.raiseEvent(r.GameAction.Jump,{direction:i.Direction.Right,targetCell:u}):a.raiseEvent(r.GameAction.Turn,{direction:i.Direction.Right})}}})}).onDraw(function(t,e){var n=h.x,o=h.y;i.Sprite.get(r.SpriteID.HUD).draw(e,n,o,{tileX:!0}),i.Sprite.get(r.SpriteID.ExitButton).draw(e,n,o),Object(c.getDigitDrawInstances)(u,!0).forEach(function(t){return i.Sprite.get(r.SpriteID.Digits).draw(e,n+g/2-32+t.x,o+12,{frame:t.frame})})}).onKey(i.Key.Left,function(t,e){var n=t.getInstances().find(function(t){return t.parent===p}),r=l.getCellAtPosition(n.x,n.y).getAdjacentCell(i.Direction.Left),a=r.getAdjacentCell(i.Direction.Up),s=r.containsInstanceOf(d)||r.containsInstanceOf(f);a.isFree()&&s?l.raiseClickEvent(n.x-o.GridCellSize,n.y-o.GridCellSize):s||l.raiseClickEvent(n.x-o.GridCellSize,n.y)}).onKey(i.Key.Right,function(t,e){var n=t.getInstances().find(function(t){return t.parent===p}),r=l.getCellAtPosition(n.x,n.y).getAdjacentCell(i.Direction.Right),a=r.getAdjacentCell(i.Direction.Up),s=r.containsInstanceOf(d)||r.containsInstanceOf(f);a.isFree()&&s?l.raiseClickEvent(n.x+o.GridCellSize,n.y-o.GridCellSize):s||l.raiseClickEvent(n.x+o.GridCellSize,n.y)}).onKey(i.Key.Down,function(t,e){var n=t.getInstances().find(function(t){return t.parent===p}),r=l.getCellAtPosition(n.x,n.y),a=r.getAdjacentCell(i.Direction.Left),s=r.getAdjacentCell(i.Direction.Right),c=r.getAdjacentCell(i.Direction.Up),u=c.getAdjacentCell(i.Direction.Left),h=c.getAdjacentCell(i.Direction.Right);c.containsInstanceOf(f)?l.raiseClickEvent(n.x,n.y-o.GridCellSize):(a.containsInstanceOf(f)&&u.isFree()&&l.raiseClickEvent(n.x-o.GridCellSize,n.y),s.containsInstanceOf(f)&&h.isFree()&&l.raiseClickEvent(n.x+o.GridCellSize,n.y))})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o,r,a,s,c=n(0),u=n(3),l=n(15),h=n(2),f=n(23),p=n(6),d=n(13),g=u.GridCellSize+16,v=1,m=!1;c.Room.define(h.RoomID.LevelSelect).onStart(function(t,e){r=p.Registry.get(h.Settings.CanvasWidth),o=p.Registry.get(h.Settings.CanvasHeight),t.setBackground(u.Black,r,o,u.Black);var n=new c.ViewedRoomBehavior(0,0,r,o);t.use(n),i=n.getView();var f=Number(p.Registry.get(h.Settings.StackmoProgress));e&&e.win&&v===f&&(f++,p.Registry.set(h.Settings.StackmoProgress,f,!0)),f||(f=0);var d=Math.floor(r/g),m=Math.ceil(l.Levels.count/d),y=a=Math.floor((r-d*g)/2),C=!1;a+m*g>o&&(d--,m=Math.ceil(l.Levels.count/d),s=Math.ceil((m*g-o)/g),C=!0);for(var w=0,S=0,b=0;b<l.Levels.count;b++){var D=t.createActor(h.ActorID.LevelIcon,y+S*g,a+w*g);D.levelNumber=b+1,D.enabled=b<f,++S===d&&(S=0,w++)}if(C){var A=t.createActor(h.ActorID.ScrollArrow);A.animation.setFrame(1),A.x=r-8-u.GridCellSize,A.direction=c.Direction.Up;var k=t.createActor(h.ActorID.ScrollArrow);k.x=A.x,k.direction=c.Direction.Down}}),c.Actor.define(h.ActorID.LevelIcon,{sprite:c.Sprite.get(h.SpriteID.LevelIcon)}).onClick(function(t){if(t.enabled&&!m){m=!0;var e=t.levelNumber,n=c.Room.get(h.RoomID.Level);f.LevelBuilder.populateRoom(n,e),v=e,c.Vastgame.setRoom(h.RoomID.Level,{levelNumber:e}),m=!1}}).onDraw(function(t,e){if(t.enabled){var n=t.levelNumber;Object(d.getDigitDrawInstances)(n).forEach(function(n){return c.Sprite.get(h.SpriteID.Digits).draw(e,t.x+n.x,t.y+n.y,{frame:n.frame})})}}),c.Actor.define(h.ActorID.ScrollArrow,{sprite:c.Sprite.get(h.SpriteID.ArrowSheet)}).onClick(function(t,e){if(t.enabled){var n=t.direction;i.y+=n===c.Direction.Down?64:-64,i.y<0&&(i.y=0)}}).onStep(function(t){var e=t.direction===c.Direction.Up;t.y=e?a+i.y:o-82+i.y,t.enabled=e?i.y>0:i.y<(s+2)*g})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),o=n(3),r=n(2),a=n(6),s=0,c=0;i.Room.define(r.RoomID.Title).onStart(function(t,e){var n=a.Registry.get(r.Settings.CanvasWidth),i=a.Registry.get(r.Settings.CanvasHeight);s=Math.floor((n-o.TitleWidth)/2),c=Math.floor((i-o.TitleHeight)/4),t.setBackground(o.Black,n,i,o.Black)}).onClick(function(){i.Vastgame.setRoom(r.RoomID.LevelSelect)}).onKey(i.Key.Any,function(){i.Vastgame.setRoom(r.RoomID.LevelSelect)}).onDraw(function(t,e){i.Sprite.get(r.SpriteID.Title).draw(e,s,c)})},function(t,e,n){function i(t){return n(o(t))}function o(t){var e=r[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var r={"./actors/block":25,"./actors/block.ts":25,"./actors/player":26,"./actors/player.ts":26,"./actors/win":27,"./actors/win.ts":27,"./game":22,"./game.ts":22,"./rooms/level":28,"./rooms/level-select":29,"./rooms/level-select.ts":29,"./rooms/level.ts":28,"./rooms/title":30,"./rooms/title.ts":30,"./sprites":24,"./sprites.ts":24,"./util/constants":3,"./util/constants.ts":3,"./util/data":15,"./util/data.ts":15,"./util/enum":2,"./util/enum.ts":2,"./util/level-builder":23,"./util/level-builder.ts":23,"./util/registry":6,"./util/registry.ts":6,"./util/util":13,"./util/util.ts":13};i.keys=function(){return Object.keys(r)},i.resolve=o,t.exports=i,i.id=31}]);