!function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=19)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Vastgame",function(){return v});var o=n(13),r=n(3),i=n(4),a=n(14),s=n(15),c=n(7),u=n(8);n.d(e,"Actor",function(){return u.a}),n.d(e,"ActorInstance",function(){return u.b});var l=n(18);n.d(e,"Boundary",function(){return l.a}),n.d(e,"Enum",function(){return r}),n.d(e,"Input",function(){return i.a});var f=n(9);n.d(e,"Grid",function(){return f.a}),n.d(e,"GridCell",function(){return f.b}),n.d(e,"Room",function(){return c.a});var h=n(12);n.d(e,"GridRoomBehavior",function(){return h.a}),n.d(e,"ViewedRoomBehavior",function(){return h.b});var p=n(5);n.d(e,"Sprite",function(){return p.a}),n.d(e,"SpriteTransformation",function(){return p.c});var d=n(10);n.d(e,"View",function(){return d.a});var g=function(){function t(){}return t.prototype.init=function(t,e){i.a.init();var n=document.getElementById(t),r=new o.a(n);r.init(e.canvas),this.context=new a.a(r),this.runner=new s.a(e)},t.prototype.getContext=function(){return this.context},t.prototype.start=function(t){this.setRoom(t),this.runner.start(this.context)},t.prototype.setRoom=function(t,e){var n=c.a.get(t),o=this.context.getCurrentRoom();o&&o.end(),this.context.setCurrentRoom(n),n.hasStart&&n.callStart(e)},t}(),v=function(){function t(){}return t.init=function(t,e){this.game.init(t,e)},t.start=function(t){return this.game.start(t),this.game},t.getContext=function(){return this.game.getContext()},t.setRoom=function(t,e){this.game.setRoom(t,e)},t.game=new g,t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Settings",function(){return o}),n.d(e,"ActorID",function(){return r}),n.d(e,"RoomID",function(){return i}),n.d(e,"SpriteID",function(){return a}),n.d(e,"GameAction",function(){return s}),n.d(e,"LevelBgColor",function(){return c});var o;!function(t){t.CanvasWidth="CanvasWidth",t.CanvasHeight="CanvasHeight",t.StackmoProgress="StackmoProgress"}(o||(o={}));var r;!function(t){t.ExitButton="BackButton",t.Block="Block",t.LevelIcon="LevelIcon",t.Player="Player",t.ScrollArrow="ScrollArrow",t.Title="Title",t.Wall="Wall",t.Win="Win"}(r||(r={}));var i;!function(t){t.Title="Title",t.LevelSelect="LevelSelect",t.Level="Level"}(i||(i={}));var a;!function(t){t.Arrows="Arrows",t.Digits="Digits",t.DoorSheet="DoorSheet",t.Box="Box",t.LevelIcon="LevelIcon",t.StackmoSheet="StackmoSheet",t.TextSheet="TextSheet",t.Title="Title",t.Wall="Wall",t.X="X"}(a||(a={}));var s;!function(t){t.Drop="Drop",t.Fall="Fall",t.Jump="Jump",t.Lift="Lift",t.Move="Move",t.CheckStopMoving="CheckStopMoving",t.Stop="Stop",t.Win="Win"}(s||(s={}));var c;!function(t){t.DarkTeal="#001820",t.Teal="#006070",t.DarkGreen="#001800",t.Green="#085800",t.DarkRed="#580000",t.Red="#d01000",t.DarkPurple="#380050",t.Purple="#a008a8"}(c||(c={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Black",function(){return o}),n.d(e,"CanvasMaxWidth",function(){return r}),n.d(e,"CanvasMaxHeight",function(){return i}),n.d(e,"GridCellSize",function(){return a}),n.d(e,"BlockFallSpeed",function(){return s}),n.d(e,"PlayerMoveSpeed",function(){return c}),n.d(e,"PlayerJumpSpeed",function(){return u}),n.d(e,"PlayerFallSpeed",function(){return l});var o="#000",r=1024,i=768,a=64,s=8,c=4,u=8,l=8},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ActorState",function(){return o}),n.d(e,"Direction",function(){return r}),n.d(e,"GameState",function(){return i}),n.d(e,"Key",function(){return a});var o;!function(t){t[t.Active=1]="Active",t[t.Destroyed=2]="Destroyed"}(o||(o={}));var r;!function(t){t[t.Right=0]="Right",t[t.Down=90]="Down",t[t.Left=180]="Left",t[t.Up=270]="Up"}(r||(r={}));var i;!function(t){t[t.Running=1]="Running",t[t.Paused=2]="Paused"}(i||(i={}));var a;!function(t){t[t.Any=-1]="Any",t[t.Space=32]="Space",t[t.Left=37]="Left",t[t.Up=38]="Up",t[t.Right=39]="Right",t[t.Down=40]="Down"}(a||(a={}))},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(3),r=function(){function t(){}return Object.defineProperty(t,"clickActive",{get:function(){return!!t._activePointerEvent},enumerable:!0,configurable:!0}),t.init=function(){var e=this,n=function(e){t._activePointerEvent||(t._activePointerEvent=e,t.clickHandlers.length&&t.clickHandlers.forEach(function(t){t.isAlive&&t.callback(e)}))},r=function(){t._activePointerEvent=null};document.body.onmousedown=function(t){n(a.fromMouseEvent(t))},document.body.ontouchstart=function(t){document.body.onmousedown=null,n(a.fromTouchEvent(t))},document.body.onmouseup=r,document.body.ontouchend=r,document.body.onkeydown=function(t){var n=t.keyCode||t.code,r=e.keyboardHandlers[n];r&&r.isAlive&&!e.keyboardActivity[n]&&(e.keyboardActivity[n]=!0,r.callback(t));var i=e.keyboardHandlers[o.Key.Any];i&&i.isAlive&&!e.keyboardActivity[o.Key.Any]&&(e.keyboardActivity[o.Key.Any]=!0,i.callback(t))},document.body.onkeyup=function(t){var n=t.keyCode||t.code,r=e.keyboardHandlers[n];e.keyboardActivity[o.Key.Any]=!1,r&&r.isAlive&&(e.keyboardActivity[n]=!1)}},t.registerClickHandler=function(e){var n=new i(e);return t.clickHandlers.push(n),n},t.registerKeyHandler=function(e,n){var o=new i(n);return t.keyboardHandlers[e]=o,o},t.keyDown=function(t){return!!this.keyboardActivity[t]},t.clickHandlers=[],t.keyboardHandlers={},t.keyboardActivity={},t._activePointerEvent=null,t}(),i=function(){function t(t){this.callback=t,this.isAlive=!0}return t.prototype.dispose=function(){this.isAlive=!1},t}(),a=function(){function t(){}return t.fromMouseEvent=function(t){return{x:t.offsetX,y:t.offsetY}},t.fromTouchEvent=function(t){var e=t.touches[0];return{x:e?e.clientX:0,y:e?e.clientY:0}},t}()},function(t,e,n){"use strict";n.d(e,"c",function(){return o}),n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a});var o,r=n(0);!function(t){t[t.Opacity=0]="Opacity"}(o||(o={}));var i=function(){function t(t){this.transformatons={},this.image=new Image,this.image.src=t.imageSource,this.height=t.height,this.width=t.width,this.frameBorder=t.frameBorder,this.setDefaultTransforms()}return t.define=function(e,n){var o=new t(n);return r.Vastgame.getContext().defineSprite(e,o),o},t.get=function(t){return r.Vastgame.getContext().getSprite(t)},t.prototype.setDefaultTransforms=function(){this.transformatons[o.Opacity]=1},t.prototype.getTransform=function(t){return this.transformatons[t]},t.prototype.transform=function(t,e){this.transformatons[t]+=e},t.prototype.setTransform=function(t,e){this.transformatons[t]=e},t.prototype.getFrameImageSourceCoords=function(t){var e=this.frameBorder||0,n=0;if(this.image.width)for(var o=Math.floor(this.image.width/this.width);this.width*t>=o*this.width;)t-=o,n++;var r=t*e,i=n*e;return[t*this.width+r,n*this.height+i]},t}(),a=function(){function t(t){this.sprite=t,this.currentFrame=0,this.depth=0,this.currentFrame=0}return Object.defineProperty(t.prototype,"frame",{get:function(){return this.currentFrame},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this.sprite},enumerable:!0,configurable:!0}),t.prototype.start=function(t,e,n){var o=this;this.stop(),this.currentFrame=t,this.timer=setInterval(function(){o.currentFrame=o.currentFrame===e?t:o.currentFrame+1},n)},t.prototype.stop=function(){this.timer&&clearInterval(this.timer)},t.prototype.set=function(t){this.stop(),this.currentFrame=t},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Registry",function(){return o});var o=function(){function t(){}return t.get=function(t){return this.values[t]},t.load=function(t){return this.values[t]=localStorage.getItem(t),this.values[t]},t.set=function(t,e,n){void 0===n&&(n=!1),this.values[t]=e,n&&localStorage.setItem(t,e)},t.values={},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(8),r=n(4),i=n(0),a=function(){return function(t,e,n,o){void 0===e&&(e="#000"),this.color=t,this.pageColor=e,this.width=n,this.height=o}}(),s=function(){function t(){this.actorInstanceMap={},this.eventHandlers=[],this.behaviors=[]}return t.define=function(e){var n=new t;return i.Vastgame.getContext().defineRoom(e,n),n},t.get=function(t){return i.Vastgame.getContext().getRoom(t)},t.prototype.setBackground=function(t,e,n,o){this.background=new a(t,o,e,n),o&&(document.body.style.backgroundColor=o)},t.prototype.end=function(){this.actorInstanceMap={},this.behaviors=[],this.eventHandlers.forEach(function(t){return t.dispose()})},t.prototype.use=function(t){return this.behaviors.push(t),t},Object.defineProperty(t.prototype,"hasStart",{get:function(){return!!this.onStartCallback},enumerable:!0,configurable:!0}),t.prototype.onStart=function(t){this.onStartCallback=t},t.prototype.callStart=function(t){this.onStartCallback(t)},Object.defineProperty(t.prototype,"hasDraw",{get:function(){return!!this.onDrawCallback},enumerable:!0,configurable:!0}),t.prototype.onDraw=function(t){this.onDrawCallback=t},t.prototype.callDraw=function(){this.onDrawCallback(this)},t.prototype.onClick=function(t){var e=r.a.registerClickHandler(t);return this.eventHandlers.push(e),e},t.prototype.onKey=function(t,e){var n=r.a.registerKeyHandler(t,e);return this.eventHandlers.push(n),n},t.prototype.step=function(){var t=this;this.getInstances().forEach(function(e){var n=e.parent;e.isActive?(0!==e.speed&&t.applyInstanceMovement(e),t.checkCollisions(e),n.step(e)):t.destroyActorInstance(e)}),this.behaviors.forEach(function(e){return e.postStep(t)})},t.prototype.applyInstanceMovement=function(t){var e=Math.round(t.getMovementOffsetX()),n=Math.round(t.getMovementOffsetY());0===e&&0===n||t.setPositionRelative(e,n)},t.prototype.checkCollisions=function(t){var e=t.parent;for(var n in e.collisionHandlers){var r=e.collisionHandlers[n],i=o.a.get(n);for(var a in this.actorInstanceMap){var s=this.actorInstanceMap[a];s.parent===i&&t!==s&&t.collidesWith(s)&&r(t,s)}}},t.prototype.draw=function(t){var e=this;this.behaviors.forEach(function(n){return n.preDraw(e,t)}),this.background&&t.fill(this.background.width,this.background.height,this.background.color),this.hasDraw&&this.callDraw(),this.getInstances().sort(function(t,e){return(e.spriteAnimation?e.spriteAnimation.depth:0)-(t.spriteAnimation?t.animation.depth:0)}).forEach(function(e){e.parent.hasDraw&&e.parent.callDraw(e),e.animation&&e.visible&&t.drawSprite(e.animation.source,e.x,e.y,e.spriteAnimation.frame)})},t.prototype.drawSprite=function(t,e,n,o){var r=this;void 0===o&&(o=0);var a=i.Vastgame.getContext().getCanvas().getContext();this.behaviors.forEach(function(t){return t.preDraw(r,a)}),a.drawSprite(t,e,n,o)},t.prototype.handleClick=function(t){this.behaviors.forEach(function(e){return e.preHandleClick(t)});var e=t.x,n=t.y;this.getInstancesAtPosition(e,n).forEach(function(o){var r=o.parent;r.hasClick&&o.occupiesPosition(e,n)&&r.callClick(o,t)}),this.behaviors.forEach(function(e){return e.postHandleClick(t)})},t.prototype.createActor=function(e,n,r){var i=o.a.get(e),a=t.nextActorInstanceID(),s=new o.b(this,i,a,n,r);return this.actorInstanceMap[a]=s,i.hasCreate&&i.callCreate(s),s},t.prototype.destroyActorInstance=function(t){var e=t.parent;e.hasDestroy&&e.callDestroy(t),delete this.actorInstanceMap[t.id]},t.prototype.getInstances=function(){var t=[];for(var e in this.actorInstanceMap)t.push(this.actorInstanceMap[e]);return t},t.prototype.getInstancesAtPosition=function(t,e){return this.getInstances().filter(function(n){return n.occupiesPosition(t,e)})},t.prototype.isPositionFree=function(t,e){return!this.getInstancesAtPosition(t,e).length},t.nextActorInstanceID=function(){var t=0;return function(){return++t}}(),t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return c}),n.d(e,"b",function(){return u});var o=n(3),r=n(16),i=n(5),a=n(17),s=n(0),c=function(){function t(t,e){void 0===e&&(e={}),this.collisionHandlers={},this.actorEventHandlers={},this.boundary=e.boundary,this.name=t,this.sprite=e.sprite}return t.define=function(e,n){var o=new t(e,n);return s.Vastgame.getContext().defineActor(e,o),o},t.get=function(t){return s.Vastgame.getContext().getActor(t)},Object.defineProperty(t.prototype,"hasCreate",{get:function(){return!!this.onCreateCallback},enumerable:!0,configurable:!0}),t.prototype.onCreate=function(t){this.onCreateCallback=t},t.prototype.callCreate=function(t){this.onCreateCallback(t)},t.prototype.step=function(t){this.hasStep&&this.callStep(t),t.previousX=t.x,t.previousY=t.y},Object.defineProperty(t.prototype,"hasStep",{get:function(){return!!this.onStepCallback},enumerable:!0,configurable:!0}),t.prototype.onStep=function(t){this.onStepCallback=t},t.prototype.callStep=function(t){this.onStepCallback(t)},Object.defineProperty(t.prototype,"hasDraw",{get:function(){return!!this.onDrawCallback},enumerable:!0,configurable:!0}),t.prototype.onDraw=function(t){this.onDrawCallback=t},t.prototype.callDraw=function(t){this.onDrawCallback(t)},Object.defineProperty(t.prototype,"hasClick",{get:function(){return!!this.onClickCallback},enumerable:!0,configurable:!0}),t.prototype.onClick=function(t){this.onClickCallback=t},t.prototype.callClick=function(t,e){this.onClickCallback(t,e)},t.prototype.onCollide=function(t,e){this.collisionHandlers[t]=e},t.prototype.onEvent=function(t,e){this.actorEventHandlers[t]=e},Object.defineProperty(t.prototype,"hasDestroy",{get:function(){return!!this.onDestroyCallback},enumerable:!0,configurable:!0}),t.prototype.onDestroy=function(t){this.onDestroyCallback=t},t.prototype.callDestroy=function(t){this.onDestroyCallback(t)},t}(),u=function(){function t(t,e,n,r,a){void 0===r&&(r=0),void 0===a&&(a=0),this.room=t,this.parent=e,this.id=n,this.x=r,this.y=a,this.speed=0,this.direction=o.Direction.Right,this.visible=!0,this.state=o.ActorState.Active,this.previousX=this.x,this.previousY=this.y,this.parent.sprite&&(this.spriteAnimation=new i.b(this.parent.sprite))}return Object.defineProperty(t.prototype,"hasMoved",{get:function(){return this.x!==this.previousX||this.y!==this.previousY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state===o.ActorState.Active},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boundary",{get:function(){return this.parent.boundary},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this.spriteAnimation},enumerable:!0,configurable:!0}),t.prototype.drawSprite=function(t,e,n,o){void 0===o&&(o=0),this.room.drawSprite(t,e,n,o)},t.prototype.raiseEvent=function(t,e){this.raiseEventWhen(t,function(){return!0},e)},t.prototype.raiseEventWhen=function(t,e,n){void 0===n&&(n={}),this.setGameContextEventArgs(n);var o=this.parent.actorEventHandlers[t];if(!o)throw new Error("Attempting to raise undefined Event: "+t);r.a.register(new r.a(e,o.bind(null,this,n)))},t.prototype.setGameContextEventArgs=function(t){t.game={currentRoom:s.Vastgame.getContext().getCurrentRoom()}},t.prototype.destroy=function(){this.state=o.ActorState.Destroyed},t.prototype.collidesWith=function(t){return!!(this.hasMoved&&this.boundary&&t.boundary)&&this.boundary.atPosition(this.x,this.y).collidesWith(t.boundary.atPosition(t.x,t.y))},t.prototype.getMovementOffsetX=function(){return a.a.getLengthDirectionX(100*this.speed,this.direction)/100},t.prototype.getMovementOffsetY=function(){return a.a.getLengthDirectionY(100*this.speed,this.direction)/100},t.prototype.setPositionRelative=function(t,e){this.setPosition(this.x+t,this.y+e)},t.prototype.setPosition=function(t,e){this.previousX=this.x,this.previousY=this.y,this.x=t,this.y=e},t.prototype.move=function(t,e){this.speed=t,this.direction=e},t.prototype.occupiesPosition=function(t,e){return!!this.boundary&&this.boundary.atPosition(this.x,this.y).containsPosition(t,e)},t}()},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return a});var o=n(3),r=function(){function t(t,e,n){this.grid=t,this.x=e,this.y=n}return t.prototype.getCell=function(){var t=this.x-this.x%this.grid.tileSize,e=this.y-this.y%this.grid.tileSize;return new i(this.grid,t,e)},t}(),i=function(){function t(t,e,n){this.grid=t,this.x=e,this.y=n}return t.prototype.getAdjacentCell=function(e){var n=0,r=0;switch(e){case o.Direction.Down:r=this.grid.tileSize;break;case o.Direction.Left:n=-this.grid.tileSize;break;case o.Direction.Right:n=this.grid.tileSize;break;case o.Direction.Up:r=-this.grid.tileSize}return new t(this.grid,this.x+n,this.y+r)},t.prototype.getContents=function(){return this.grid.room.getInstancesAtPosition(this.x+this.grid.tileSize/2,this.y+this.grid.tileSize/2)},t.prototype.containsInstance=function(t){return this.getContents().some(function(e){return e===t})},t.prototype.containsInstanceOf=function(t){return this.getContents().some(function(e){return e.parent===t})},t.prototype.isFree=function(){return!this.getContents().length},t}(),a=function(){function t(t,e){this.tileSize=t,this.room=e}return t.prototype.onClick=function(t){this._onClick=t},t.prototype.raiseClickEvent=function(t,e){this.room.getInstancesAtPosition(t,e);var n=new r(this,t,e);this._onClick(n)},t.prototype.getCellAtPosition=function(t,e){return new i(this,t,e)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o;!function(t){t[t.SamePosition=1]="SamePosition",t[t.Center=2]="Center"}(o||(o={}));var r=function(){function t(t,e,n,o){this.x=t,this.y=e,this.width=n,this.height=o,this.attachments=[]}return t.prototype.follow=function(t,e){void 0===e&&(e=!1),this.viewMode=e?o.Center:o.SamePosition,this.followInstance=t},t.prototype.attach=function(t,e,n){this.attachments.push(new i(this,t,e,n))},t.prototype.update=function(){this.followInstance&&(this.viewMode===o.Center?this.centerAroundBoundary(this.followInstance.boundary):(this.x=this.followInstance.x||0,this.y=this.followInstance.y||0),this.attachments.forEach(function(t){return t.update()}))},t.prototype.centerAroundBoundary=function(t){if(!t)throw new Error("boundary is "+t);this.x=this.followInstance.x+t.width/2-this.width/2,this.y=this.followInstance.y+t.height/2-this.height/2},t}(),i=function(){function t(t,e,n,o){this.parent=t,this.instance=e,this.offsetX=n,this.offsetY=o}return t.prototype.update=function(){this.instance.x=this.parent.x+this.offsetX,this.instance.y=this.parent.y+this.offsetY},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"SpriteFader",function(){return r});var o=n(0),r=function(){function t(){}return t.fadeOut=function(t,e){var n=1,r=setInterval(function(){n-=.25,t.forEach(function(t){return t.transform(o.SpriteTransformation.Opacity,-.25)}),n<=0&&(clearInterval(r),setTimeout(e,200))},100)},t.fadeIn=function(t,e){var n=0;t.forEach(function(t){return t.setTransform(o.SpriteTransformation.Opacity,0)});var r=setInterval(function(){n+=.25,t.forEach(function(t){return t.transform(o.SpriteTransformation.Opacity,.25)}),n>=1&&(clearInterval(r),e&&setInterval(e,200))},100)},t}()},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return a});var o=n(9),r=n(10),i=function(){function t(t,e,n,o){this.view=new r.a(t,e,n,o)}return t.prototype.getView=function(){return this.view},t.prototype.preHandleClick=function(t){var e=this.getOffset(),n=e[0],o=e[1];t.x+=n,t.y+=o},t.prototype.postStep=function(t){this.view.update()},t.prototype.preDraw=function(t,e){var n=this.getOffset(),o=n[0],r=n[1];e.origin=[-o,-r]},t.prototype.postHandleClick=function(t){},t.prototype.getOffset=function(){return[this.view?this.view.x:0,this.view?this.view.y:0]},t}(),a=function(){function t(t,e){this.grid=new o.a(t,e)}return t.prototype.getGrid=function(){return this.grid},t.prototype.postHandleClick=function(t){this.grid.raiseClickEvent(t.x,t.y)},t.prototype.preHandleClick=function(t){},t.prototype.postStep=function(t){},t.prototype.preDraw=function(t,e){},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(5),r=function(){function t(t){this.canvasElement=t,this.gameCanvasContext=new i(this.canvasElement)}return t.prototype.getContext=function(){return this.gameCanvasContext},t.prototype.init=function(t){this.canvasElement&&(this.canvasElement.height=t.height,this.canvasElement.width=t.width)},t}(),i=function(){function t(t){this.canvasElement=t,this.origin=[0,0]}return Object.defineProperty(t.prototype,"canvasContext2D",{get:function(){return this.canvasElement.getContext("2d")},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this.canvasContext2D.clearRect(0,0,this.canvasElement.width,this.canvasElement.height)},t.prototype.fill=function(t,e,n){var o=this.origin,r=o[0],i=o[1];this.fillArea(r,i,t,e,n)},t.prototype.fillArea=function(t,e,n,o,r){this.canvasContext2D.beginPath(),this.canvasContext2D.rect(t,e,n,o),this.canvasContext2D.fillStyle=r,this.canvasContext2D.fill()},t.prototype.drawSprite=function(t,e,n,r){void 0===r&&(r=0);var i=t.getFrameImageSourceCoords(r),a=i[0],s=i[1],c=t.getTransform(o.c.Opacity),u=null;1!==c&&null!==c&&void 0!==c&&(u=this.canvasContext2D.globalAlpha,this.canvasContext2D.globalAlpha=c);var l=this.origin,f=l[0],h=l[1];this.canvasContext2D.drawImage(t.image,a,s,t.width,t.height,Math.floor(f+e),Math.floor(h+n),t.width,t.height),null!==u&&(this.canvasContext2D.globalAlpha=u)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(4),r=function(){function t(t){this.canvas=t,this.actors={},this.events={},this.rooms={},this.sprites={},this.nextEventID=function(){var t=0;return function(){return++t}}()}return t.prototype.getCanvas=function(){return this.canvas},t.prototype.defineActor=function(t,e){if(this.actors[t])throw new Error("Actor "+t+" has already been defined.");this.actors[t]=e},t.prototype.getActor=function(t){if(!this.actors[t])throw new Error("Actor "+t+" has not been defined.");return this.actors[t]},t.prototype.registerEvent=function(t){this.events[this.nextEventID()]=t},t.prototype.checkAndFireEvents=function(){for(var t in this.events){var e=this.events[t];e.conditionCallback()&&(e.actionCallback(),e.fireOnce&&delete this.events[t])}},t.prototype.defineRoom=function(t,e){if(this.rooms[t])throw new Error("Room "+t+" has already been defined.");this.rooms[t]=e},t.prototype.getRoom=function(t){if(!this.rooms[t])throw new Error("Room "+t+" has not been defined.");return this.rooms[t]},t.prototype.getCurrentRoom=function(){return this.currentRoom},t.prototype.setCurrentRoom=function(t){this.currentRoom=t,this.currentRoomClickHandler&&this.currentRoomClickHandler.dispose(),this.currentRoomClickHandler=o.a.registerClickHandler(function(e){return t.handleClick(e)})},t.prototype.defineSprite=function(t,e){if(this.sprites[t])throw new Error("Sprite "+t+" has already been defined.");this.sprites[t]=e},t.prototype.getSprite=function(t){if(!this.sprites[t])throw new Error("Sprite "+t+" has not been defined.");return this.sprites[t]},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n(3),r=60,i=function(){function t(t){this.options=t,this.state=o.GameState.Paused,this.targetFPS=t.targetFPS||r}return Object.defineProperty(t.prototype,"isRunning",{get:function(){return this.state===o.GameState.Running},enumerable:!0,configurable:!0}),t.prototype.pause=function(){this.state=o.GameState.Paused},t.prototype.start=function(t){var e=this,n=1/this.targetFPS,r=0,i=window.performance.now(),a=t.getCanvas().getContext(),s=function(){var o=t.getCurrentRoom(),c=window.performance.now();for(r+=Math.min(1,(c-i)/1e3);r>n;){if(!e.isRunning)return;t.checkAndFireEvents(),o.step(),r-=n}e.isRunning&&(a.clear(),o.draw(a)),i=c,requestAnimationFrame(s)};this.state=o.GameState.Running,requestAnimationFrame(s)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(0),r=function(){function t(t,e,n){void 0===n&&(n=!0),this.conditionCallback=t,this.actionCallback=e,this.fireOnce=n}return t.register=function(t){o.Vastgame.getContext().registerEvent(t)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(){}return t.getLengthDirectionX=function(t,e){return t*Math.cos(e*(Math.PI/180))},t.getLengthDirectionY=function(t,e){return t*Math.sin(e*(Math.PI/180))},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=function(){function t(t,e,n){this.x=t,this.y=e,this.height=n.height,this.width=n.width}return t.prototype.collidesWith=function(t){return!(this.x>t.x+t.width||t.x>=this.x+this.width)&&!(this.y>t.y+t.height||t.y>=this.y+this.height)},t.prototype.containsPosition=function(t,e){return!(this.x>t||t>this.x+this.width)&&!(this.y>e||e>this.y+this.height)},t}(),r=function(){function t(t,e,n){if(void 0===n&&(n=!1),this.height=t,this.width=e,this.solid=n,t<=0||e<=0)throw new Error("Height and width must both be greater than zero.")}return t.fromSprite=function(e,n){return void 0===n&&(n=!1),new t(e.height,e.width,n)},t.prototype.atPosition=function(t,e){return new o(t,e,this)},t}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(1),i=n(20),a=Object(i.buildCanvasDimensions)(),s=a[0],c=a[1];i.Registry.set(r.Settings.CanvasWidth,s),i.Registry.set(r.Settings.CanvasHeight,c),o.Vastgame.init("game",{canvas:{width:s,height:c}}),Object(i.requireModules)("actors",["block","hud","player","wall","win"]),Object(i.requireModules)("rooms",["level","level-select","title"]),i.Registry.load(r.Settings.StackmoProgress),i.Registry.set(r.Settings.StackmoProgress,99,!0),o.Vastgame.start(r.RoomID.Title)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.requireModules=function(t,e){e.forEach(function(e){return n(30)("./"+t+"/"+e)})},e.buildCanvasDimensions=function(){var t=window.innerWidth<o.CanvasMaxWidth,e=t?window.innerWidth:o.CanvasMaxWidth;e+=e%2==0?0:1;var n=t?window.innerHeight:o.CanvasMaxHeight;return n+=n%2==0?0:1,[e,n]};var o=n(2),r=n(6);n.d(e,"Registry",function(){return r.Registry})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"LevelBuilder",function(){return s}),n.d(e,"Levels",function(){return c});var o,r=n(0),i=n(1),a=n(2),s=function(){function t(){}return t.populateRoom=function(t,e){var n=a.GridCellSize,o=(r.Actor.get("Block"),r.Actor.get("Player"),r.Actor.get("Wall"),r.Actor.get("Win"),[]),s=c.get(e),u={0:[i.LevelBgColor.Teal,i.LevelBgColor.DarkTeal],1:[i.LevelBgColor.Green,i.LevelBgColor.DarkGreen],2:[i.LevelBgColor.Red,i.LevelBgColor.DarkRed],3:[i.LevelBgColor.Purple,i.LevelBgColor.DarkPurple]},l=(e-1)%4;t.setBackground(u[l][0],s[0].length*n,s.length*n,u[l][1]);for(var f=0;f<s.length;f++)for(var h=s[f],p=0;p<h.length;p++)switch(h.charAt(p)){case"X":o.push(t.createActor(i.ActorID.Block,p*n,f*n));break;case"P":o.push(t.createActor(i.ActorID.Player,p*n,f*n));break;case"W":o.push(t.createActor(i.ActorID.Win,p*n,f*n));break;case"#":var d=t.createActor(i.ActorID.Wall,p*n,f*n),g=this.getWallFrame(s,e,f,p);g=this.getWallFrameRowOffeset(l,g),d.spriteAnimation.set(g),o.push(d)}return o},t.getWallFrameRowOffeset=function(t,e){return e+41*t},t.getWallFrame=function(t,e,n,r){var i=t[0].length-1,a=t.length-1,s=n>0&&"#"!==t[n-1][r],c=n>0&&r>0&&"#"!==t[n-1][r-1],u=n>0&&r<i&&"#"!==t[n-1][r+1],l=n<a&&"#"!==t[n+1][r],f=n<a&&r>0&&"#"!==t[n+1][r-1],h=n<a&&r<i&&"#"!==t[n+1][r+1],p=r>0&&"#"!==t[n][r-1],d=r<i&&"#"!==t[n][r+1];return s||c||u||p||d||f||l||h?s||c||u||p||d||f||l?s||c||u||p||d||l||h?s||c||p||d||f||l||h?s||u||p||d||f||l||h?s||c||p||f||l||d?s||u||d||h||l||p?p||f||l||h||d||s?p||c||s||u||d||l?s||c||p||f||l?s||u||d||h||l?p||f||l||h||d?p||c||s||u||d?s||p||l||d||h?s||p||l||d||f?s||p||l||d||u?s||p||l||d||c?s||p||l||d?p||d||h||l?p||d||f||l?p||d||u||s?p||d||c||s?s||d||h||l?s||p||f||l?l||d||u||s?l||p||c||s?d||h||l?p||f||l?d||u||s?p||c||s?s||l||p?s||l||d?s||p||d?p||d||l?p||d?s||l?s?p?l?d?o.Solo:o.CappedLeft:o.CappedTop:o.CappedRight:o.CappedBottom:o.NarrowVertical:o.NarrowHorizontal:o.ThreewayNarrowBottom:o.ThreewayNarrowTop:o.ThreewayNarrowRight:o.ThreewayNarrowLeft:o.OuterCornerBottomRight:o.OuterCornerBottomLeft:o.OuterCornerTopRight:o.OuterCornerTopLeft:o.FlatRightNarrowBottom:o.FlatLeftNarrowBottom:o.FlatRightNarrowTop:o.FlatLeftNarrowTop:o.FlatBottomNarrowRight:o.FlatBottomNarrowLeft:o.FlatTopNarrowRight:o.FlatTopNarrowLeft:o.Fourway:o.TwoWayBottomRight:o.TwoWayBottomLeft:o.TwoWayTopRight:o.TwoWayTopLeft:o.FlatTop:o.FlatBottom:o.FlatRight:o.FlatLeft:o.ThreewayBottom:o.ThreewayTop:o.ThreewayLeft:o.ThreewayRight:o.InnerCornerBottomRight:o.InnerCornerBottomLeft:o.InnerCornerTopRight:o.InnerCornerTopLeft:o.Inner},t}(),c=function(){function t(){}return Object.defineProperty(t,"count",{get:function(){var t=0;for(var e in this.levels)t++;return t},enumerable:!0,configurable:!0}),t.get=function(t){return this.levels[t]},t.levels={1:["################","#              #","#              #","#              #","#X        #    #","### P  #  #  W #","################"],2:["#################","#               #","#               #","#          #    #","#XX        #    #","#### P   # #  W #","#################"],3:["################","#              #","#              #","#         #    #","#XX       #    #","###X  P   #  W #","################"],4:["################","#              #","#              #","#X        #  W #","#XX       #  ###","###X  P   #  ###","################"],5:["################","#       #      #","#       #    W #","#            ###","#X      #      #","#XX P   #X   XX#","################"],6:["##################","#                #","#              W #","#              ###","#        X     ###","#X       #    X###","#XX P #      XX###","##################"],7:["##################","#               W#","#               ##","#       ######  ##","#XX          #####","#######          #","#          #    X#","#XX P      #   XX#","##################"],8:["##############","#W           #","##           #","##P          #","### X      XX#","#####    #####","#####        #","#####      XX#","##############"],9:["#####################","###############    ##","##############   # ##","###              # ##","##      X   P   ## ##","#     ############ ##","#        ######### ##","#X    XXX######### ##","################## ##","##############     ##","#########    # ######","######### #      ####","######### #         #","######### ######    #","######### ##       ##","######### ##XXX  ####","######### ###########","#########         W##","#####################"]},t}();!function(t){t[t.InnerCornerTopLeft=0]="InnerCornerTopLeft",t[t.FlatTop=1]="FlatTop",t[t.InnerCornerTopRight=2]="InnerCornerTopRight",t[t.OuterCornerTopLeft=3]="OuterCornerTopLeft",t[t.OuterCornerBottomLeft=4]="OuterCornerBottomLeft",t[t.FlatLeft=5]="FlatLeft",t[t.Inner=6]="Inner",t[t.FlatRight=7]="FlatRight",t[t.OuterCornerTopRight=8]="OuterCornerTopRight",t[t.InnerCornerBottomLeft=9]="InnerCornerBottomLeft",t[t.FlatBottom=10]="FlatBottom",t[t.InnerCornerBottomRight=11]="InnerCornerBottomRight",t[t.OuterCornerBottomRight=12]="OuterCornerBottomRight",t[t.NarrowHorizontal=13]="NarrowHorizontal",t[t.NarrowVertical=14]="NarrowVertical",t[t.CappedLeft=15]="CappedLeft",t[t.CappedTop=16]="CappedTop",t[t.CappedRight=17]="CappedRight",t[t.CappedBottom=18]="CappedBottom",t[t.ThreewayNarrowTop=19]="ThreewayNarrowTop",t[t.ThreewayNarrowRight=20]="ThreewayNarrowRight",t[t.ThreewayNarrowBottom=21]="ThreewayNarrowBottom",t[t.ThreewayNarrowLeft=22]="ThreewayNarrowLeft",t[t.Fourway=23]="Fourway",t[t.Solo=24]="Solo",t[t.ThreewayTop=25]="ThreewayTop",t[t.ThreewayRight=26]="ThreewayRight",t[t.ThreewayBottom=27]="ThreewayBottom",t[t.ThreewayLeft=28]="ThreewayLeft",t[t.FlatTopNarrowLeft=29]="FlatTopNarrowLeft",t[t.FlatTopNarrowRight=30]="FlatTopNarrowRight",t[t.FlatBottomNarrowLeft=31]="FlatBottomNarrowLeft",t[t.FlatBottomNarrowRight=32]="FlatBottomNarrowRight",t[t.FlatLeftNarrowTop=33]="FlatLeftNarrowTop",t[t.FlatRightNarrowTop=34]="FlatRightNarrowTop",t[t.FlatLeftNarrowBottom=35]="FlatLeftNarrowBottom",t[t.FlatRightNarrowBottom=36]="FlatRightNarrowBottom",t[t.TwoWayTopLeft=37]="TwoWayTopLeft",t[t.TwoWayTopRight=38]="TwoWayTopRight",t[t.TwoWayBottomLeft=39]="TwoWayBottomLeft",t[t.TwoWayBottomRight=40]="TwoWayBottomRight"}(o||(o={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(2),i=n(1),a=o.Sprite.define(i.SpriteID.Box,{imageSource:"../resources/box.png",height:r.GridCellSize,width:r.GridCellSize}),s=o.Actor.define(i.ActorID.Block,{boundary:o.Boundary.fromSprite(a),sprite:a});s.onEvent(i.GameAction.Fall,function(t,e){if(e.game.currentRoom.isPositionFree(t.x+1,t.y+r.GridCellSize+1)){var n=t.y;e.targetCell=e.targetCell.getAdjacentCell(o.Enum.Direction.Down),t.move(r.BlockFallSpeed,o.Enum.Direction.Down),t.raiseEventWhen(i.GameAction.Stop,function(){return Math.abs(n-t.y)>=r.GridCellSize},e)}}),s.onEvent(i.GameAction.Stop,function(t,e){var n=e.game.currentRoom,o=e.targetCell;t.move(0),t.setPosition(o.x,o.y),n.isPositionFree(t.x+1,t.y+r.GridCellSize+1)&&t.raiseEvent(i.GameAction.Fall,e)})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(2),i=n(1),a=o.Sprite.define(i.SpriteID.X,{imageSource:"../resources/x.png",height:r.GridCellSize,width:r.GridCellSize}),s=o.Actor.define(i.ActorID.ExitButton,{boundary:o.Boundary.fromSprite(a),sprite:a});s.onCreate(function(t){return t.animation.depth=-10}),s.onClick(function(){return o.Vastgame.setRoom(i.RoomID.LevelSelect)})},function(t,e,n){"use strict";function o(t,e,n){void 0===n&&(n=!1);var o=f.StandRight;o=r?e===a.Enum.Direction.Right?f.StandHoldRight:f.StandHoldLeft:e===a.Enum.Direction.Right?f.StandRight:f.StandLeft,n?t.spriteAnimation.start(o+1,o+2,100):t.spriteAnimation.set(o)}Object.defineProperty(e,"__esModule",{value:!0});var r,i,a=n(0),s=n(2),c=n(1),u=a.Sprite.define(c.SpriteID.StackmoSheet,{imageSource:"../resources/stackmo_sheet.png",height:s.GridCellSize,width:s.GridCellSize,frameBorder:4}),l=a.Actor.define(c.ActorID.Player,{boundary:a.Boundary.fromSprite(u),sprite:u});l.onCreate(function(t){t.animation.depth=-50,i=a.Enum.Direction.Right,r=null}),l.onStep(function(t){r&&r.setPosition(t.x,t.y-s.GridCellSize)}),l.onEvent(c.GameAction.Move,function(t,e){var n=e.targetCell,u=e.direction,l=t.x;i=u,(!r||r&&n.getAdjacentCell(a.Enum.Direction.Up).isFree())&&(t.move(s.PlayerMoveSpeed,u),t.raiseEventWhen(c.GameAction.CheckStopMoving,function(){return Math.abs(l-t.x)>=s.GridCellSize},e),o(t,u,!0))}),l.onEvent(c.GameAction.CheckStopMoving,function(t,e){var n=e.targetCell,o=c.GameAction.Stop;if(t.move(0),t.setPosition(n.x,n.y),a.Input.clickActive||a.Input.keyDown(i===a.Enum.Direction.Left?a.Enum.Key.Left:a.Enum.Key.Right)){var r=n.getAdjacentCell(i),s=n.getAdjacentCell(a.Enum.Direction.Down);r.isFree()&&!s.isFree()&&(e.targetCell=r,o=c.GameAction.Move)}t.raiseEvent(o,e)}),l.onEvent(c.GameAction.Fall,function(t,e){var n=t.y,r=e.direction;e.targetCell=e.targetCell.getAdjacentCell(a.Enum.Direction.Down),t.move(s.PlayerFallSpeed,a.Enum.Direction.Down),t.raiseEventWhen(c.GameAction.Stop,function(){return Math.abs(n-t.y)>=s.GridCellSize},e),o(t,r,!1)}),l.onEvent(c.GameAction.Stop,function(t,e){var n=e.game.currentRoom,r=e.targetCell;t.move(0),t.setPosition(r.x,r.y),n.isPositionFree(t.x+1,t.y+s.GridCellSize+1)?t.raiseEvent(c.GameAction.Fall,e):o(t,i);var u=a.Actor.get(c.ActorID.Win);r.containsInstanceOf(u)&&n.getInstances().find(function(t){return t.parent===u}).raiseEvent(c.GameAction.Win)}),l.onEvent(c.GameAction.Jump,function(t,e){var n=e.targetCell,o=e.direction,i=t.y,u=n.getAdjacentCell(o===a.Enum.Direction.Right?a.Enum.Direction.Left:a.Enum.Direction.Right),l=r?u.getAdjacentCell(a.Enum.Direction.Up):null;if(l?l.isFree()&&l.getAdjacentCell(o).isFree():u.isFree()){t.move(s.PlayerJumpSpeed,a.Enum.Direction.Up),t.raiseEventWhen(c.GameAction.Move,function(){return Math.abs(i-t.y)>=s.GridCellSize},e)}}),l.onEvent(c.GameAction.Lift,function(t,e){var n=e.block,s=e.targetCell,u=i===a.Enum.Direction.Left?a.Enum.Direction.Right:a.Enum.Direction.Left,l=s.getAdjacentCell(a.Enum.Direction.Up),f=l.getAdjacentCell(u);(r||l.isFree()&&f.isFree())&&(r&&n===r?t.raiseEvent(c.GameAction.Drop,e):!r&&s.getAdjacentCell(u).containsInstance(t)&&(r=n,o(t,i)))}),l.onEvent(c.GameAction.Drop,function(t,e){var n=e.block,u=e.targetCell,l=i===a.Enum.Direction.Left?-s.GridCellSize:s.GridCellSize;u.getAdjacentCell(i).isFree()&&(e.targetCell=e.targetCell.getAdjacentCell(i),r=null,n.setPositionRelative(l,0),n.raiseEvent(c.GameAction.Fall,e),o(t,i))});var f;!function(t){t[t.StandLeft=0]="StandLeft",t[t.MoveLeft1=1]="MoveLeft1",t[t.MoveLeft2=2]="MoveLeft2",t[t.StandRight=3]="StandRight",t[t.MoveRight1=4]="MoveRight1",t[t.MoveRight2=5]="MoveRight2",t[t.StandHoldLeft=6]="StandHoldLeft",t[t.MoveHoldLeft1=7]="MoveHoldLeft1",t[t.MoveHoldLeft2=8]="MoveHoldLeft2",t[t.StandHoldRight=9]="StandHoldRight",t[t.MoveHoldRight1=10]="MoveHoldRight1",t[t.MoveHolddRight2=11]="MoveHolddRight2"}(f||(f={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(2),i=n(1),a=o.Sprite.define(i.SpriteID.Wall,{imageSource:"../resources/wall_sheet.png",height:r.GridCellSize,width:r.GridCellSize,frameBorder:1});o.Actor.define(i.ActorID.Wall,{boundary:o.Boundary.fromSprite(a,!0),sprite:a})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(2),i=n(1),a=o.Sprite.define(i.SpriteID.DoorSheet,{imageSource:"../resources/door_sheet.png",height:r.GridCellSize,width:32,frameBorder:1}),s=o.Actor.define(i.ActorID.Win,{boundary:o.Boundary.fromSprite(a,!0),sprite:a}),c=!1,u=!1,l=0;s.onCreate(function(t){t.animation.depth=-10,t.visible=!1}),s.onStep(function(t){c?l++:u&&l--}),s.onDraw(function(t){t.drawSprite(a,t.x-l,t.y,0),t.drawSprite(a,t.x+32+l,t.y,1)}),s.onEvent(i.GameAction.Win,function(t,e){t.raiseEvent("open")}),s.onEvent("open",function(t,e){c=!0,setTimeout(function(){t.raiseEvent("close")},500)}),s.onEvent("close",function(t,e){c=!1,t.animation.depth=-100,setTimeout(function(){u=!0,setTimeout(function(){t.raiseEvent("home")},500)},500)}),s.onEvent("home",function(t,e){l=0,u=!1,setTimeout(function(){o.Vastgame.setRoom(i.RoomID.LevelSelect,{win:!0})},500)})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(2),i=n(1),a=n(6),s=n(11),c=n(12),u=o.Room.define(i.RoomID.Level);u.onStart(function(){var t=o.Actor.get(i.ActorID.Block),e=o.Actor.get(i.ActorID.ExitButton),n=o.Actor.get(i.ActorID.Player),l=o.Actor.get(i.ActorID.Wall),f=(o.Actor.get(i.ActorID.Win),o.Sprite.get(i.SpriteID.DoorSheet));s.SpriteFader.fadeIn([e.sprite,t.sprite,n.sprite,l.sprite,f]);var h=u.getInstances().find(function(t){return t.parent===n}),p=a.Registry.get(i.Settings.CanvasWidth),d=a.Registry.get(i.Settings.CanvasHeight),g=r.GridCellSize/4,v=new o.ViewedRoomBehavior(0,0,p,d);u.use(v);var m=v.getView();m.follow(h,!0),m.attach(u.createActor(i.ActorID.ExitButton),p-r.GridCellSize-g,g);var y=new c.a(r.GridCellSize,u);u.use(y);var C=y.getGrid();C.onClick(function(e){var n=e.getCell();if(!h.speed&&!n.getContents().some(function(t){return t.parent===l})){var r=n.getAdjacentCell(o.Enum.Direction.Left),a=n.getAdjacentCell(o.Enum.Direction.Right),s=n.getAdjacentCell(o.Enum.Direction.Down),c=r.getAdjacentCell(o.Enum.Direction.Down),u=a.getAdjacentCell(o.Enum.Direction.Down);n.containsInstanceOf(t)?h.raiseEvent(i.GameAction.Lift,{block:n.getContents()[0],targetCell:n}):a.containsInstance(h)?h.raiseEvent(i.GameAction.Move,{direction:o.Enum.Direction.Left,targetCell:n}):r.containsInstance(h)?h.raiseEvent(i.GameAction.Move,{direction:o.Enum.Direction.Right,targetCell:n}):c.containsInstance(h)&&(s.containsInstanceOf(t)||s.containsInstanceOf(l))?h.raiseEvent(i.GameAction.Jump,{direction:o.Enum.Direction.Right,targetCell:n}):u.containsInstance(h)&&(s.containsInstanceOf(t)||s.containsInstanceOf(l))&&h.raiseEvent(i.GameAction.Jump,{direction:o.Enum.Direction.Left,targetCell:n})}}),u.onKey(o.Enum.Key.Left,function(){var e=C.getCellAtPosition(h.x,h.y).getAdjacentCell(o.Enum.Direction.Left),n=e.getAdjacentCell(o.Enum.Direction.Up),i=e.containsInstanceOf(l)||e.containsInstanceOf(t);n.isFree()&&i?C.raiseClickEvent(h.x-r.GridCellSize,h.y-r.GridCellSize):i||C.raiseClickEvent(h.x-r.GridCellSize,h.y)}),u.onKey(o.Enum.Key.Right,function(){var e=C.getCellAtPosition(h.x,h.y).getAdjacentCell(o.Enum.Direction.Right),n=e.getAdjacentCell(o.Enum.Direction.Up),i=e.containsInstanceOf(l)||e.containsInstanceOf(t);n.isFree()&&i?C.raiseClickEvent(h.x+r.GridCellSize,h.y-r.GridCellSize):i||C.raiseClickEvent(h.x+r.GridCellSize,h.y)}),u.onKey(o.Enum.Key.Down,function(){var e=C.getCellAtPosition(h.x,h.y),n=e.getAdjacentCell(o.Enum.Direction.Left),i=e.getAdjacentCell(o.Enum.Direction.Right),a=e.getAdjacentCell(o.Enum.Direction.Up),s=a.getAdjacentCell(o.Enum.Direction.Left),c=a.getAdjacentCell(o.Enum.Direction.Right);a.containsInstanceOf(t)?C.raiseClickEvent(h.x,h.y-r.GridCellSize):(n.containsInstanceOf(t)&&s.isFree()&&C.raiseClickEvent(h.x-r.GridCellSize,h.y),i.containsInstanceOf(t)&&c.isFree()&&C.raiseClickEvent(h.x+r.GridCellSize,h.y))})})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r,i,a,s,c=n(0),u=n(2),l=n(1),f=n(21),h=n(11),p=n(6),d=u.GridCellSize+16,g=c.Room.define(l.RoomID.LevelSelect),v=1,m=!1;g.onStart(function(t){r=p.Registry.get(l.Settings.CanvasWidth),o=p.Registry.get(l.Settings.CanvasHeight),g.setBackground(u.Black,r,o,u.Black),g.use(new c.ViewedRoomBehavior(0,0,r,o));var e=Number(p.Registry.get(l.Settings.StackmoProgress));t&&t.win&&v===e&&(e++,p.Registry.set(l.Settings.StackmoProgress,e,!0)),e||(e=0);var n=Math.floor(r/d),m=!1,S=Math.ceil(f.Levels.count/n);i=Math.floor((r-n*d)/2),(a=Math.floor(o/6))+S*d>o&&(n--,S=Math.ceil(f.Levels.count/n),s=Math.ceil((S*d-o)/d),m=!0);for(var D=0,R=0,k=0;k<f.Levels.count;k++){var E=g.createActor(l.ActorID.LevelIcon,i+R*d,a+D*d);E.levelNumber=k+1,E.enabled=k<e,++R===n&&(R=0,D++)}if(m){var I=g.createActor(l.ActorID.ScrollArrow);I.spriteAnimation.set(1),I.x=r-8-A.sprite.width,I.direction=c.Enum.Direction.Up;var x=g.createActor(l.ActorID.ScrollArrow);x.x=I.x,x.direction=c.Enum.Direction.Down}h.SpriteFader.fadeIn([y,C,w,b])});var y=c.Sprite.define(l.SpriteID.TextSheet,{imageSource:"../resources/text_sheet.png",height:32,width:320});g.onDraw(function(t){t.drawSprite(y,i,Math.floor(a/2-y.height),0)});var C=c.Sprite.define(l.SpriteID.Digits,{imageSource:"../resources/digits_sheet.png",height:u.GridCellSize/2,width:u.GridCellSize/2}),w=c.Sprite.define(l.SpriteID.LevelIcon,{imageSource:"../resources/level_icon.png",width:u.GridCellSize,height:u.GridCellSize}),S=c.Actor.define(l.ActorID.LevelIcon,{boundary:c.Boundary.fromSprite(w),sprite:w});S.onClick(function(t){t.enabled&&!m&&(m=!0,h.SpriteFader.fadeOut([y,C,w,b],function(){var e=t.levelNumber,n=c.Room.get(l.RoomID.Level);f.LevelBuilder.populateRoom(n,e),v=e,c.Vastgame.setRoom(l.RoomID.Level),m=!1}))}),S.onDraw(function(t){if(t.enabled){var e=t.levelNumber,n=Math.floor((w.width-C.width)/2);if(e<10){var o=e;t.drawSprite(C,t.x+n,t.y+n,o)}else{var r=Math.floor(e/10),i=Math.floor(n/2)-3;t.drawSprite(C,t.x+i,t.y+n,r);var a=e%10,s=Math.floor(2*n)-3;t.drawSprite(C,t.x+s,t.y+n,a)}}});var b=c.Sprite.define(l.SpriteID.Arrows,{imageSource:"../resources/arrows.png",height:u.GridCellSize,width:u.GridCellSize}),A=c.Actor.define(l.ActorID.ScrollArrow,{boundary:c.Boundary.fromSprite(b),sprite:b});A.onClick(function(t,e){if(t.enabled){var n=t.direction;(void 0).y+=n===c.Enum.Direction.Down?64:-64,(void 0).y<0&&((void 0).y=0)}}),A.onStep(function(t){var e=t.direction===c.Enum.Direction.Up;t.y=e?a+(void 0).y:o-82+(void 0).y,t.enabled=e?(void 0).y>0:(void 0).y<(s+2)*d})},function(t,e,n){"use strict";function o(){r(),c.SpriteFader.fadeOut([h],function(){i.Vastgame.setRoom(s.RoomID.LevelSelect)})}function r(){d&&d.dispose(),g&&g.dispose()}Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(2),s=n(1),c=n(11),u=n(6),l=0,f=0,h=i.Sprite.define(s.SpriteID.Title,{imageSource:"../resources/title.png",width:360,height:150}),p=i.Room.define(s.RoomID.Title);p.onStart(function(){var t=u.Registry.get(s.Settings.CanvasWidth),e=u.Registry.get(s.Settings.CanvasHeight);l=Math.floor((t-360)/2),f=Math.floor((e-150)/4),p.setBackground(a.Black,t,e,a.Black),c.SpriteFader.fadeIn([h])}),p.onDraw(function(t){t.drawSprite(h,l,f)});var d=p.onClick(o),g=p.onKey(i.Enum.Key.Any,o)},function(t,e,n){function o(t){return n(r(t))}function r(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var i={"./actors/block":22,"./actors/block.ts":22,"./actors/hud":23,"./actors/hud.ts":23,"./actors/player":24,"./actors/player.ts":24,"./actors/wall":25,"./actors/wall.ts":25,"./actors/win":26,"./actors/win.ts":26,"./game":19,"./game.ts":19,"./rooms/level":27,"./rooms/level-select":28,"./rooms/level-select.ts":28,"./rooms/level.ts":27,"./rooms/title":29,"./rooms/title.ts":29,"./util/constants":2,"./util/constants.ts":2,"./util/enum":1,"./util/enum.ts":1,"./util/level-builder":21,"./util/level-builder.ts":21,"./util/registry":6,"./util/registry.ts":6,"./util/sprite-fader":11,"./util/sprite-fader.ts":11,"./util/util":20,"./util/util.ts":20};o.keys=function(){return Object.keys(i)},o.resolve=r,t.exports=o,o.id=30}]);